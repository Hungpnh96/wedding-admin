<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Site Admin - Qu·∫£n l√Ω website c∆∞·ªõi</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Quill Editor -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Admin Styles -->
    <link href="./admin/css/admin-styles.css" rel="stylesheet">
    <link href="./admin/css/admin-enhanced.css" rel="stylesheet">
    
    <style>
        .banner-preview {
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 20px;
            background: #f8f9fa;
            min-height: 200px;
        }
        
        .main-banner-preview {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .banner-overlay {
            position: absolute;
            top: 10px;
            left: 10px;
        }
        
        .thumbnail-preview {
            position: relative;
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .thumbnail-preview:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .thumbnail-preview.active {
            border: 2px solid #007bff;
        }
        
        .thumbnail-overlay {
            position: absolute;
            top: 5px;
            right: 5px;
        }
        
        .banner-info {
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .banner-stats {
            padding: 10px;
            background: #e9ecef;
            border-radius: 4px;
            margin-top: 10px;
        }
        
        /* Professional Preview Styles */
        .preview-container {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .preview-main {
            position: relative;
            height: 400px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .preview-slideshow {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        .preview-slides {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .preview-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        
        .preview-slide.active {
            opacity: 1;
        }
        
        .preview-image-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        .preview-main-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .preview-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }
        
        .preview-content {
            text-align: center;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .preview-title {
            font-size: 1.5rem;
            font-weight: 300;
            margin-bottom: 1rem;
            letter-spacing: 2px;
        }
        
        .preview-names {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.2;
        }
        
        .preview-date {
            font-size: 1.2rem;
            font-weight: 300;
            opacity: 0.9;
        }
        
        .preview-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 3;
        }
        
        .preview-badge .badge {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }
        
        .preview-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 8px;
            z-index: 3;
        }
        
        .preview-control-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .preview-control-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        
        .preview-info {
            padding: 24px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }
        
        .info-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .info-header h5 {
            color: #495057;
            margin-bottom: 16px;
            font-weight: 600;
        }
        
        .info-content {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f3f4;
        }
        
        .info-item:last-child {
            border-bottom: none;
        }
        
        .info-item label {
            font-weight: 500;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .info-item span {
            color: #495057;
            font-weight: 500;
        }
        
        .preview-gallery {
            padding: 24px;
        }
        
        /* Story Management Styles */
        .stories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .story-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }
        
        .story-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }
        
        .story-card.dragging {
            opacity: 0.7;
            transform: rotate(5deg);
        }
        
        .story-image {
            width: 100%;
            height: auto;
            max-height: 300px;
            object-fit: contain;
            object-position: center;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .story-content {
            padding: 20px;
        }
        
        .story-milestone {
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .story-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #495057;
            margin-bottom: 10px;
            line-height: 1.3;
        }
        
        .story-description {
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .story-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .story-card:hover .story-actions {
            opacity: 1;
        }
        
        .story-action-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .story-action-btn.edit {
            background: #007bff;
            color: white;
        }
        
        .story-action-btn.delete {
            background: #dc3545;
            color: white;
        }
        
        .story-action-btn.visibility {
            background: #28a745;
            color: white;
        }
        
        .story-action-btn:hover {
            transform: scale(1.1);
        }
        
        .story-status {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .story-status.visible {
            background: #d4edda;
            color: #155724;
        }
        
        .story-status.hidden {
            background: #f8d7da;
            color: #721c24;
        }
        
        .story-form-container {
            margin-bottom: 30px;
        }
        
        .story-form-container .card {
            border: none;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        
        .story-form-container .card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }
        
        .story-form-container .btn-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            opacity: 0.8;
        }
        
        .story-form-container .btn-close:hover {
            opacity: 1;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .empty-stories {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }
        
        .empty-stories i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .empty-stories h5 {
            margin-bottom: 10px;
            color: #495057;
        }
        
        .drag-handle {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 20px;
            background: rgba(0,0,0,0.1);
            border-radius: 10px;
            cursor: grab;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .story-card:hover .drag-handle {
            opacity: 1;
        }
        
        .drag-handle:active {
            cursor: grabbing;
        }
        
        .drag-handle::before {
            content: "‚ãÆ‚ãÆ";
            font-size: 0.8rem;
            color: #6c757d;
        }
        
        .gallery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .gallery-header h5 {
            color: #495057;
            margin: 0;
            font-weight: 600;
        }
        
        .gallery-count {
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
        }
        
        .gallery-item {
            cursor: pointer;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .gallery-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .gallery-item.active {
            border-color: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,123,255,0.3);
        }
        
        .gallery-image {
            position: relative;
            aspect-ratio: 4/3;
            overflow: hidden;
        }
        
        .gallery-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .gallery-item:hover .gallery-image img {
            transform: scale(1.05);
        }
        
        .gallery-overlay {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0,0,0,0.7);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .gallery-info {
            padding: 12px;
            background: white;
        }
        
        .gallery-title {
            font-size: 0.85rem;
            color: #495057;
            font-weight: 500;
            display: block;
            text-align: center;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: #f8f9fa;
            border-radius: 16px;
            border: 2px dashed #dee2e6;
        }
        
        .empty-icon {
            font-size: 4rem;
            color: #adb5bd;
            margin-bottom: 20px;
        }
        
        .empty-state h4 {
            color: #495057;
            margin-bottom: 12px;
            font-weight: 600;
        }
        
        .empty-state p {
            color: #6c757d;
            margin-bottom: 24px;
            font-size: 1.1rem;
        }
        
        .empty-state .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 500;
        }
        
    </style>

</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">ƒêang x·ª≠ l√Ω...</p>
        </div>
    </div>

    <div class="admin-container">
        <!-- Header -->
        <div class="admin-header">
            <h1><i class="fas fa-heart me-2"></i>Wedding Site Admin</h1>
            <p>Qu·∫£n l√Ω website c∆∞·ªõi chuy√™n nghi·ªáp</p>
        </div>

        <!-- Navigation -->
        <ul class="nav nav-pills admin-nav" id="adminTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="overview-tab" data-bs-toggle="pill" data-bs-target="#overview" type="button" role="tab">
                    <i class="fas fa-tachometer-alt me-2"></i>T·ªïng quan
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="hero-tab" data-bs-toggle="pill" data-bs-target="#hero" type="button" role="tab">
                    <i class="fas fa-star me-2"></i>Trang ch·ªß
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="couple-tab" data-bs-toggle="pill" data-bs-target="#couple" type="button" role="tab">
                    <i class="fas fa-users me-2"></i>C·∫∑p ƒë√¥i
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="story-tab" data-bs-toggle="pill" data-bs-target="#story" type="button" role="tab">
                    <i class="fas fa-book me-2"></i>C√¢u chuy·ªán
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="gallery-tab" data-bs-toggle="pill" data-bs-target="#gallery" type="button" role="tab">
                    <i class="fas fa-images me-2"></i>Th∆∞ vi·ªán ·∫£nh
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="payment-tab" data-bs-toggle="pill" data-bs-target="#payment" type="button" role="tab">
                    <i class="fas fa-credit-card me-2"></i>Chuy·ªÉn kho·∫£n
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="event-tab" data-bs-toggle="pill" data-bs-target="#event" type="button" role="tab">
                    <i class="fas fa-calendar-alt me-2"></i>S·ª± ki·ªán
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="wishes-tab" data-bs-toggle="pill" data-bs-target="#wishes" type="button" role="tab">
                    <i class="fas fa-heart me-2"></i>L·ªùi ch√∫c
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="theme-tab" data-bs-toggle="pill" data-bs-target="#theme" type="button" role="tab">
                    <i class="fas fa-palette me-2"></i>Giao di·ªán
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="layout-tab" data-bs-toggle="pill" data-bs-target="#layout" type="button" role="tab">
                    <i class="fas fa-th-large me-2"></i>B·ªë c·ª•c
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="settings-tab" data-bs-toggle="pill" data-bs-target="#settings" type="button" role="tab">
                    <i class="fas fa-cog me-2"></i>C√†i ƒë·∫∑t
                </button>
            </li>
        </ul>

        <!-- Content -->
        <div class="tab-content admin-content" id="adminTabContent">
            <!-- Overview Tab -->
            <div class="tab-pane fade show active" id="overview" role="tabpanel">
                <div class="row">
                    <div class="col-md-8">
                        <div class="section-card">
                            <div class="section-header">
                                <h5><i class="fas fa-chart-line me-2"></i>Th·ªëng k√™ nhanh</h5>
                            </div>
                            <div class="section-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="text-center">
                                            <div class="h3 text-primary mb-1" id="totalImages">0</div>
                                            <div class="text-muted">H√¨nh ·∫£nh</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center">
                                            <div class="h3 text-success mb-1" id="totalStories">0</div>
                                            <div class="text-muted">C√¢u chuy·ªán</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center">
                                            <div class="h3 text-warning mb-1" id="totalSections">0</div>
                                            <div class="text-muted">Ph·∫ßn n·ªôi dung</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="text-center">
                                            <div class="h3 text-info mb-1" id="lastUpdated">Ch∆∞a c·∫≠p nh·∫≠t</div>
                                            <div class="text-muted">L·∫ßn cu·ªëi</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-card">
                            <div class="section-header">
                                <h5><i class="fas fa-eye me-2"></i>Xem tr∆∞·ªõc website</h5>
                            </div>
                            <div class="section-body">
                                <p class="text-muted mb-3">Nh·∫•n n√∫t b√™n d∆∞·ªõi ƒë·ªÉ xem tr∆∞·ªõc website v·ªõi c√°c thay ƒë·ªïi hi·ªán t·∫°i.</p>
                                <button class="btn btn-custom" onclick="previewWebsite()">
                                    <i class="fas fa-external-link-alt me-2"></i>Xem tr∆∞·ªõc website
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="section-card">
                            <div class="section-header">
                                <h5><i class="fas fa-save me-2"></i>L∆∞u tr·ªØ & Xu·∫•t</h5>
                            </div>
                            <div class="section-body">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-success" onclick="saveSiteData()">
                                        <i class="fas fa-save me-2"></i>L∆∞u thay ƒë·ªïi
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="downloadData()">
                                        <i class="fas fa-download me-2"></i>T·∫£i file JSON
                                    </button>
                                    <button class="btn btn-outline-secondary" onclick="loadData()">
                                        <i class="fas fa-upload me-2"></i>Nh·∫≠p file JSON
                                    </button>
                                    <button class="btn btn-outline-info" onclick="exportUploadedFiles()">
                                        <i class="fas fa-file-export me-2"></i>Xu·∫•t file ·∫£nh
                                    </button>
                                    <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="handleFileUpload(this)">
                                </div>
                            </div>
                        </div>

                        <div class="section-card">
                            <div class="section-header">
                                <h5><i class="fas fa-info-circle me-2"></i>H∆∞·ªõng d·∫´n nhanh</h5>
                            </div>
                            <div class="section-body">
                                <div class="alert alert-info">
                                    <small>
                                        <strong>üí° M·∫πo:</strong><br>
                                        ‚Ä¢ K√©o th·∫£ ƒë·ªÉ s·∫Øp x·∫øp n·ªôi dung<br>
                                        ‚Ä¢ Click v√†o ·∫£nh ƒë·ªÉ thay ƒë·ªïi<br>
                                        ‚Ä¢ S·ª≠ d·ª•ng n√∫t "Xem tr∆∞·ªõc" ƒë·ªÉ ki·ªÉm tra<br>
                                        ‚Ä¢ Nh·ªõ l∆∞u thay ƒë·ªïi tr∆∞·ªõc khi ƒë√≥ng
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hero Tab -->
            <div class="tab-pane fade" id="hero" role="tabpanel">
                <!-- Basic Info Section -->
                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-star me-2"></i>Th√¥ng tin c∆° b·∫£n</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">T√™n ch√∫ r·ªÉ</label>
                                    <input type="text" class="form-control" id="groomName" placeholder="Nh·∫≠p t√™n ch√∫ r·ªÉ">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">T√™n c√¥ d√¢u</label>
                                    <input type="text" class="form-control" id="brideName" placeholder="Nh·∫≠p t√™n c√¥ d√¢u">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Ng√†y c∆∞·ªõi</label>
                                    <input type="date" class="form-control" id="weddingDate">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Gi·ªù c∆∞·ªõi</label>
                                    <input type="time" class="form-control" id="weddingTime" placeholder="HH:MM">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">ƒê·ªãa ƒëi·ªÉm</label>
                                    <input type="text" class="form-control" id="weddingLocation" placeholder="Nh·∫≠p ƒë·ªãa ƒëi·ªÉm t·ªï ch·ª©c">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Ti√™u ƒë·ªÅ website</label>
                                    <input type="text" class="form-control" id="mainTitle" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ ch√≠nh">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">M√¥ t·∫£ ng·∫Øn</label>
                                    <textarea class="form-control" id="description" rows="3" placeholder="Nh·∫≠p m√¥ t·∫£ ng·∫Øn v·ªÅ website"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">M√†u ch·ªß ƒë·∫°o</label>
                                    <input type="color" class="form-control" id="primaryColor" value="#9f5958">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Banner Images Management -->
                <div class="section-card">
                    <div class="section-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-images me-2"></i>Qu·∫£n l√Ω ·∫£nh banner</h5>
                        <div class="btn-group">
                            <button class="btn btn-outline-secondary btn-sm" onclick="reloadBannerData()" title="T·∫£i l·∫°i d·ªØ li·ªáu t·ª´ server">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                            <button class="btn btn-outline-danger btn-sm" onclick="clearBannerSlides()" title="X√≥a t·∫•t c·∫£ ·∫£nh banner">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="btn btn-custom btn-sm" onclick="addBannerSlide()">
                                <i class="fas fa-plus me-2"></i>Th√™m ·∫£nh banner
                            </button>
                        </div>
                    </div>
                    <div class="section-body">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>H∆∞·ªõng d·∫´n:</strong> Click v√†o n√∫t "Th√™m ·∫£nh banner" ƒë·ªÉ th√™m banner m·ªõi. Click v√†o ·∫£nh ƒë·ªÉ thay ƒë·ªïi ·∫£nh banner hi·ªán c√≥.
                        </div>

                        <!-- Banner Slides List -->
                        <div id="bannerSlidesList">
                            <!-- Banner slides will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Banner Preview -->
                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-eye me-2"></i>Xem tr∆∞·ªõc banner</h5>
                    </div>
                    <div class="section-body">
                        <div class="banner-preview-container">
                            <div id="bannerPreview" class="banner-preview">
                                <!-- Banner preview will be loaded here -->
                            </div>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-outline-primary btn-sm" onclick="refreshPreview()">
                                <i class="fas fa-sync me-2"></i>L√†m m·ªõi xem tr∆∞·ªõc
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Couple Tab -->
            <div class="tab-pane fade" id="couple" role="tabpanel">
                <div class="row">
                    <div class="col-md-6">
                        <div class="section-card">
                            <div class="section-header">
                                <h5><i class="fas fa-male me-2"></i>Th√¥ng tin ch√∫ r·ªÉ</h5>
                            </div>
                            <div class="section-body">
                                <div class="form-group">
                                    <label class="form-label">T√™n ch√∫ r·ªÉ</label>
                                    <input type="text" class="form-control" id="groomNameDetail" placeholder="Nh·∫≠p t√™n ch√∫ r·ªÉ">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">M√¥ t·∫£ v·ªÅ ch√∫ r·ªÉ</label>
                                    <textarea class="form-control" id="groomDescription" rows="4" placeholder="Nh·∫≠p m√¥ t·∫£ v·ªÅ ch√∫ r·ªÉ"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Cha ch√∫ r·ªÉ</label>
                                    <input type="text" class="form-control" id="groomFather" placeholder="Nh·∫≠p t√™n cha ch√∫ r·ªÉ">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">M·∫π ch√∫ r·ªÉ</label>
                                    <input type="text" class="form-control" id="groomMother" placeholder="Nh·∫≠p t√™n m·∫π ch√∫ r·ªÉ">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="section-card">
                            <div class="section-header">
                                <h5><i class="fas fa-female me-2"></i>Th√¥ng tin c√¥ d√¢u</h5>
                            </div>
                            <div class="section-body">
                                <div class="form-group">
                                    <label class="form-label">T√™n c√¥ d√¢u</label>
                                    <input type="text" class="form-control" id="brideNameDetail" placeholder="Nh·∫≠p t√™n c√¥ d√¢u">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">M√¥ t·∫£ v·ªÅ c√¥ d√¢u</label>
                                    <textarea class="form-control" id="brideDescription" rows="4" placeholder="Nh·∫≠p m√¥ t·∫£ v·ªÅ c√¥ d√¢u"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Cha c√¥ d√¢u</label>
                                    <input type="text" class="form-control" id="brideFather" placeholder="Nh·∫≠p t√™n cha c√¥ d√¢u">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">M·∫π c√¥ d√¢u</label>
                                    <input type="text" class="form-control" id="brideMother" placeholder="Nh·∫≠p t√™n m·∫π c√¥ d√¢u">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Couple Detail Images Management -->
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="section-card">
                            <div class="section-header">
                                <h5><i class="fas fa-image me-2"></i>·∫¢nh chi ti·∫øt The Groom</h5>
                            </div>
                            <div class="section-body">
                                <div class="form-group">
                                    <label class="form-label">·∫¢nh ch√≠nh The Groom</label>
                                    <div class="image-upload-area" data-upload-type="groom" onclick="selectCoupleImage('groom')">
                                        <div class="upload-placeholder">
                                            <i class="fas fa-user fa-3x mb-3"></i>
                                            <p>Nh·∫•n ƒë·ªÉ t·∫£i ·∫£nh The Groom</p>
                                        </div>
                                        <img id="groom-image-preview" class="uploaded-image" style="display: none; width: 100%; height: auto; aspect-ratio: 1/1; object-fit: cover; border-radius: 12px; box-shadow: inset 0 0 0 15px #fff;">
                                    </div>
                                    <small class="form-text text-muted">·∫¢nh n√†y s·∫Ω hi·ªÉn th·ªã trong ph·∫ßn "The Groom" tr√™n website</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="section-card">
                            <div class="section-header">
                                <h5><i class="fas fa-image me-2"></i>·∫¢nh chi ti·∫øt The Bride</h5>
                            </div>
                            <div class="section-body">
                                <div class="form-group">
                                    <label class="form-label">·∫¢nh ch√≠nh The Bride</label>
                                    <div class="image-upload-area" data-upload-type="bride" onclick="selectCoupleImage('bride')">
                                        <div class="upload-placeholder">
                                            <i class="fas fa-user fa-3x mb-3"></i>
                                            <p>Nh·∫•n ƒë·ªÉ t·∫£i ·∫£nh The Bride</p>
                                        </div>
                                        <img id="bride-image-preview" class="uploaded-image" style="display: none; width: 100%; height: auto; aspect-ratio: 1/1; object-fit: cover; border-radius: 12px; box-shadow: inset 0 0 0 15px #fff;">
                                    </div>
                                    <small class="form-text text-muted">·∫¢nh n√†y s·∫Ω hi·ªÉn th·ªã trong ph·∫ßn "The Bride" tr√™n website</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Story Tab -->
            <div class="tab-pane fade" id="story" role="tabpanel">
                <div class="section-card">
                    <div class="section-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-book me-2"></i>Qu·∫£n l√Ω c√¢u chuy·ªán</h5>
                        <button class="btn btn-custom btn-sm" onclick="addStory()">
                            <i class="fas fa-plus me-2"></i>Th√™m c√¢u chuy·ªán
                        </button>
                    </div>
                    <div class="section-body">
                        <!-- Stories List -->
                        <div id="storiesList">
                            <div class="stories-grid" id="storiesGrid">
                                <!-- Stories will be loaded here dynamically -->
                            </div>
                        </div>
                        
                        <!-- Story Form (Hidden by default) -->
                        <div id="storyForm" class="story-form-container" style="display: none;">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0">
                                        <i class="fas fa-edit me-2"></i>
                                        <span id="storyFormTitle">Th√™m c√¢u chuy·ªán m·ªõi</span>
                                    </h6>
                                    <button type="button" class="btn-close" onclick="closeStoryForm()"></button>
                                </div>
                                <div class="card-body">
                                    <form id="storyFormElement" onsubmit="handleStorySubmit(event)">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group mb-3">
                                                    <label class="form-label">M·ªëc s·ª± ki·ªán</label>
                                                    <input type="text" class="form-control" id="storyMilestone" 
                                                           placeholder="V√≠ d·ª•: Ng√†y g·∫∑p nhau l·∫ßn ƒë·∫ßu" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group mb-3">
                                                    <label class="form-label">Ti√™u ƒë·ªÅ</label>
                                                    <input type="text" class="form-control" id="storyTitle" 
                                                           placeholder="V√≠ d·ª•: üíï L·∫ßn ƒë·∫ßu g·∫∑p m·∫∑t" required>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group mb-3">
                                            <label class="form-label">·∫¢nh minh h·ªça</label>
                                            <div class="image-upload-area" data-upload-type="story" onclick="uploadStoryImage()">
                                                <input type="file" id="storyImageInput" accept="image/*" style="display: none;" onchange="handleStoryImageSelect(event)">
                                                <div class="upload-placeholder">
                                                    <i class="fas fa-image fa-3x mb-3"></i>
                                                    <p>Nh·∫•n ƒë·ªÉ ch·ªçn ·∫£nh</p>
                                                    <small class="text-muted">JPG, PNG, WebP (T·ªëi ƒëa 5MB)</small>
                                                </div>
                                                <img id="storyImagePreview" class="uploaded-image" style="display: none; width: 100%; height: auto; max-height: 250px; object-fit: contain; object-position: center; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                                                <div id="storyImageActions" style="display: none; margin-top: 10px; text-align: center;">
                                                    <button type="button" class="btn btn-sm btn-danger" onclick="removeStoryImage()">
                                                        <i class="fas fa-trash me-1"></i>X√≥a ·∫£nh
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group mb-3">
                                            <label class="form-label">N·ªôi dung c√¢u chuy·ªán</label>
                                            <textarea class="form-control" id="storyDescription" rows="6" 
                                                      placeholder="Vi·∫øt n·ªôi dung c√¢u chuy·ªán c·ªßa b·∫°n..." required></textarea>
                                        </div>
                                        
                                        <div class="form-group mb-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="storyVisible" checked>
                                                <label class="form-check-label" for="storyVisible">
                                                    Hi·ªÉn th·ªã tr√™n website
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="form-actions">
                                            <button type="button" class="btn btn-secondary" onclick="closeStoryForm()">
                                                <i class="fas fa-times me-2"></i>H·ªßy
                                            </button>
                                            <button type="button" class="btn btn-custom" onclick="handleStorySubmit(event)">
                                                <i class="fas fa-save me-2"></i>L∆∞u c√¢u chuy·ªán
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Story Sync Controls -->
                        <div class="story-sync-controls mt-4">
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn btn-info btn-sm" onclick="previewOnMainPage()">
                                        <i class="fas fa-eye"></i> Xem tr∆∞·ªõc tr√™n trang ch√≠nh
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <button class="btn btn-warning btn-sm" onclick="forceReloadMainPage()">
                                        <i class="fas fa-sync"></i> ƒê·ªìng b·ªô d·ªØ li·ªáu
                                    </button>
                                </div>
                            </div>
                            <div class="alert alert-info mt-3">
                                <i class="fas fa-info-circle"></i>
                                <strong>H∆∞·ªõng d·∫´n:</strong> Sau khi ch·ªânh s·ª≠a c√¢u chuy·ªán, nh·∫•n "ƒê·ªìng b·ªô d·ªØ li·ªáu" v√† refresh trang index ƒë·ªÉ xem thay ƒë·ªïi.
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>

            <!-- Gallery Tab -->
            <div class="tab-pane fade" id="gallery" role="tabpanel">
                <div class="section-card">
                    <div class="section-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-images me-2"></i>Th∆∞ vi·ªán ·∫£nh</h5>
                        <button class="btn btn-custom btn-sm" onclick="addGalleryImage()">
                            <i class="fas fa-plus me-2"></i>Th√™m ·∫£nh
                        </button>
                    </div>
                    <div class="section-body">
                        <div class="image-upload-area" onclick="uploadMultipleImages()">
                            <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Click ƒë·ªÉ t·∫£i nhi·ªÅu ·∫£nh ho·∫∑c k√©o th·∫£ v√†o ƒë√¢y</p>
                            <small class="text-muted">H·ªó tr·ª£ JPG, PNG, WebP</small>
                        </div>
                        <div class="row mt-4" id="galleryImages">
                            <!-- Gallery images will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>


            <!-- Payment Tab -->
            <div class="tab-pane fade" id="payment" role="tabpanel">
                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-credit-card me-2"></i>Th√¥ng tin chuy·ªÉn kho·∫£n</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">T√™n ng√¢n h√†ng</label>
                                    <input type="text" class="form-control" id="bankName" placeholder="V√≠ d·ª•: Vietcombank">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">S·ªë t√†i kho·∫£n</label>
                                    <input type="text" class="form-control" id="accountNumber" placeholder="Nh·∫≠p s·ªë t√†i kho·∫£n">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="form-label">T√™n ch·ªß t√†i kho·∫£n</label>
                                    <input type="text" class="form-control" id="accountHolder" placeholder="T√™n ng∆∞·ªùi nh·∫≠n">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="form-label">QR Code chung</label>
                                    <div class="image-upload-area" data-upload-type="qr">
                                        <div class="upload-placeholder">
                                            <i class="fas fa-qrcode fa-3x mb-3"></i>
                                            <p>Nh·∫•n ƒë·ªÉ t·∫£i QR Code</p>
                                        </div>
                                        <img id="qrCodePreview" class="uploaded-image" style="display: none;">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="form-label">QR Code ch√∫ r·ªÉ</label>
                                    <div class="image-upload-area" data-upload-type="groomQR">
                                        <div class="upload-placeholder">
                                            <i class="fas fa-male fa-3x mb-3"></i>
                                            <p>QR Code ch√∫ r·ªÉ</p>
                                        </div>
                                        <img id="groomQRPreview" class="uploaded-image" style="display: none;">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="form-label">QR Code c√¥ d√¢u</label>
                                    <div class="image-upload-area" data-upload-type="brideQR">
                                        <div class="upload-placeholder">
                                            <i class="fas fa-female fa-3x mb-3"></i>
                                            <p>QR Code c√¥ d√¢u</p>
                                        </div>
                                        <img id="brideQRPreview" class="uploaded-image" style="display: none;">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">L·ªùi nh·∫Øn c·∫£m ∆°n</label>
                                    <textarea class="form-control" id="paymentMessage" rows="4" placeholder="C·∫£m ∆°n b·∫°n ƒë√£ g·ª≠i l·ªùi ch√∫c v√† qu√† m·ª´ng!"></textarea>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="paymentVisible">
                                    <label class="form-check-label">
                                        Hi·ªÉn th·ªã th√¥ng tin chuy·ªÉn kho·∫£n tr√™n website
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Event Tab -->
            <div class="tab-pane fade" id="event" role="tabpanel">
                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-calendar-alt me-2"></i>Th√¥ng tin s·ª± ki·ªán</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Ng√†y c∆∞·ªõi</label>
                                    <input type="date" class="form-control" id="weddingDate">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Gi·ªù l·ªÖ c∆∞·ªõi</label>
                                    <input type="time" class="form-control" id="weddingTime">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Ng√†y l·ªÖ c∆∞·ªõi</label>
                                    <input type="date" class="form-control" id="ceremonyDate">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Gi·ªù l·ªÖ c∆∞·ªõi</label>
                                    <input type="time" class="form-control" id="ceremonyTime">
                                </div>
                            </div>
                            <div class="col-12">
                                <h6 class="mt-4 mb-3">L·ªÖ c∆∞·ªõi</h6>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="form-label">T√™n ƒë·ªãa ƒëi·ªÉm l·ªÖ c∆∞·ªõi</label>
                                    <input type="text" class="form-control" id="ceremonyVenue" placeholder="Nh·∫≠p t√™n ƒë·ªãa ƒëi·ªÉm">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="form-label">ƒê·ªãa ch·ªâ l·ªÖ c∆∞·ªõi</label>
                                    <textarea class="form-control" id="ceremonyAddress" rows="2" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ chi ti·∫øt"></textarea>
                                </div>
                            </div>
                            <div class="col-12">
                                <h6 class="mt-4 mb-3">Ti·ªác c∆∞·ªõi</h6>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">T√™n ƒë·ªãa ƒëi·ªÉm ti·ªác</label>
                                    <input type="text" class="form-control" id="receptionVenue" placeholder="Nh·∫≠p t√™n ƒë·ªãa ƒëi·ªÉm">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Gi·ªù ti·ªác</label>
                                    <input type="time" class="form-control" id="receptionTime">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="form-label">ƒê·ªãa ch·ªâ ti·ªác c∆∞·ªõi</label>
                                    <textarea class="form-control" id="receptionAddress" rows="2" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ chi ti·∫øt"></textarea>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="form-label">Link Google Maps</label>
                                    <input type="url" class="form-control" id="googleMapsLink" placeholder="https://maps.google.com/...">
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="eventVisible">
                                    <label class="form-check-label">
                                        Hi·ªÉn th·ªã th√¥ng tin s·ª± ki·ªán tr√™n website
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Wishes Tab -->
            <div class="tab-pane fade" id="wishes" role="tabpanel">
                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-heart me-2"></i>T√πy ch·ªânh l·ªùi ch√∫c</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-12">
                                <div class="form-group">
                                    <label class="form-label">L·ªùi nh·∫Øn m·∫∑c ƒë·ªãnh</label>
                                    <textarea class="form-control" id="wishesMessage" rows="3" placeholder="H√£y g·ª≠i l·ªùi ch√∫c c·ªßa b·∫°n ƒë·ªÉ chia s·∫ª ni·ªÅm vui c√πng ch√∫ng m√¨nh!"></textarea>
                                </div>
                            </div>
                            <div class="col-12">
                                <h6 class="mt-3 mb-3">G·ª£i √Ω l·ªùi ch√∫c</h6>
                                <div id="wishesSuggestions">
                                    <!-- Suggestions will be loaded here -->
                                </div>
                                <button class="btn btn-outline-primary btn-sm mt-2" onclick="addWishSuggestion()">
                                    <i class="fas fa-plus me-1"></i>Th√™m g·ª£i √Ω
                                </button>
                            </div>
                            <div class="col-12">
                                <div class="form-check mt-3">
                                    <input class="form-check-input" type="checkbox" id="wishesVisible">
                                    <label class="form-check-label">
                                        Hi·ªÉn th·ªã ph·∫ßn l·ªùi ch√∫c tr√™n website
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Theme Tab -->
            <div class="tab-pane fade" id="theme" role="tabpanel">
                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-palette me-2"></i>T√πy ch·ªânh m√†u s·∫Øc</h5>
                    </div>
                    <div class="section-body">
                        <!-- Color Presets -->
                        <div class="form-group mb-4">
                            <label class="form-label">B·ªô m√†u c√≥ s·∫µn</label>
                            <div class="color-presets d-flex flex-wrap gap-2">
                                <div class="color-preset" data-theme="wedding" onclick="applyColorPreset('wedding')">
                                    <div class="preset-colors">
                                        <div class="preset-color" style="background: #9f5958;"></div>
                                        <div class="preset-color" style="background: #f8f9fa;"></div>
                                        <div class="preset-color" style="background: #2c3e50;"></div>
                                    </div>
                                    <small>Wedding Classic</small>
                                </div>
                                <div class="color-preset" data-theme="romantic" onclick="applyColorPreset('romantic')">
                                    <div class="preset-colors">
                                        <div class="preset-color" style="background: #e74c3c;"></div>
                                        <div class="preset-color" style="background: #fdf2f8;"></div>
                                        <div class="preset-color" style="background: #1f2937;"></div>
                                    </div>
                                    <small>Romantic Pink</small>
                                </div>
                                <div class="color-preset" data-theme="elegant" onclick="applyColorPreset('elegant')">
                                    <div class="preset-colors">
                                        <div class="preset-color" style="background: #2c3e50;"></div>
                                        <div class="preset-color" style="background: #ecf0f1;"></div>
                                        <div class="preset-color" style="background: #34495e;"></div>
                                    </div>
                                    <small>Elegant Blue</small>
                                </div>
                                <div class="color-preset" data-theme="golden" onclick="applyColorPreset('golden')">
                                    <div class="preset-colors">
                                        <div class="preset-color" style="background: #f39c12;"></div>
                                        <div class="preset-color" style="background: #fef9e7;"></div>
                                        <div class="preset-color" style="background: #8b4513;"></div>
                                    </div>
                                    <small>Golden Luxury</small>
                                </div>
                                <div class="color-preset" data-theme="forest" onclick="applyColorPreset('forest')">
                                    <div class="preset-colors">
                                        <div class="preset-color" style="background: #27ae60;"></div>
                                        <div class="preset-color" style="background: #eafaf1;"></div>
                                        <div class="preset-color" style="background: #1e8449;"></div>
                                    </div>
                                    <small>Forest Green</small>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-circle text-primary me-1"></i>M√†u ch·ªß ƒë·∫°o
                                    </label>
                                    <div class="color-input-group">
                                        <input type="color" class="form-control color-picker" id="primaryThemeColor" value="#9f5958">
                                        <input type="text" class="form-control color-text" id="primaryThemeColorText" value="#9f5958" placeholder="#9f5958">
                                    </div>
                                    <small class="form-text text-muted">M√†u ch√≠nh c·ªßa website</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-circle text-secondary me-1"></i>M√†u ph·ª•
                                    </label>
                                    <div class="color-input-group">
                                        <input type="color" class="form-control color-picker" id="secondaryThemeColor" value="#f8f9fa">
                                        <input type="text" class="form-control color-text" id="secondaryThemeColorText" value="#f8f9fa" placeholder="#f8f9fa">
                                    </div>
                                    <small class="form-text text-muted">M√†u n·ªÅn v√† ph·ª•</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-font me-1" style="color: #2c3e50;"></i>M√†u vƒÉn b·∫£n
                                    </label>
                                    <div class="color-input-group">
                                        <input type="color" class="form-control color-picker" id="textColor" value="#2c3e50">
                                        <input type="text" class="form-control color-text" id="textColorText" value="#2c3e50" placeholder="#2c3e50">
                                    </div>
                                    <small class="form-text text-muted">M√†u ch·ªØ ch√≠nh</small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-square me-1" style="color: #ffffff; border: 1px solid #ccc;"></i>M√†u n·ªÅn
                                    </label>
                                    <div class="color-input-group">
                                        <input type="color" class="form-control color-picker" id="backgroundColor" value="#ffffff">
                                        <input type="text" class="form-control color-text" id="backgroundColorText" value="#ffffff" placeholder="#ffffff">
                                    </div>
                                    <small class="form-text text-muted">M√†u n·ªÅn ch√≠nh</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-square me-1" style="color: #dee2e6;"></i>M√†u vi·ªÅn
                                    </label>
                                    <div class="color-input-group">
                                        <input type="color" class="form-control color-picker" id="borderColor" value="#dee2e6">
                                        <input type="text" class="form-control color-text" id="borderColorText" value="#dee2e6" placeholder="#dee2e6">
                                    </div>
                                    <small class="form-text text-muted">M√†u vi·ªÅn v√† ph√¢n c√°ch</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">
                                        <i class="fas fa-star me-1" style="color: #e74c3c;"></i>M√†u accent
                                    </label>
                                    <div class="color-input-group">
                                        <input type="color" class="form-control color-picker" id="accentColor" value="#e74c3c">
                                        <input type="text" class="form-control color-text" id="accentColorText" value="#e74c3c" placeholder="#e74c3c">
                                    </div>
                                    <small class="form-text text-muted">M√†u nh·∫•n v√† highlight</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-font me-2"></i>T√πy ch·ªânh font ch·ªØ</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Font ch√≠nh</label>
                                    <select class="form-control" id="primaryFont">
                                        <option value="'Segoe UI', sans-serif">Segoe UI</option>
                                        <option value="'Roboto', sans-serif">Roboto</option>
                                        <option value="'Open Sans', sans-serif">Open Sans</option>
                                        <option value="'Lato', sans-serif">Lato</option>
                                        <option value="'Poppins', sans-serif">Poppins</option>
                                        <option value="'Montserrat', sans-serif">Montserrat</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Font ti√™u ƒë·ªÅ</label>
                                    <select class="form-control" id="headingFont">
                                        <option value="'Playfair Display', serif">Playfair Display</option>
                                        <option value="'Merriweather', serif">Merriweather</option>
                                        <option value="'Lora', serif">Lora</option>
                                        <option value="'Source Serif Pro', serif">Source Serif Pro</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">K√≠ch th∆∞·ªõc font ch√≠nh</label>
                                    <input type="range" class="form-range" id="baseFontSize" min="12" max="20" value="16">
                                    <small class="form-text text-muted">16px</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">K√≠ch th∆∞·ªõc font ti√™u ƒë·ªÅ</label>
                                    <input type="range" class="form-range" id="headingFontSize" min="24" max="48" value="32">
                                    <small class="form-text text-muted">32px</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-eye me-2"></i>Xem tr∆∞·ªõc theme</h5>
                    </div>
                    <div class="section-body">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Thay ƒë·ªïi s·∫Ω ƒë∆∞·ª£c √°p d·ª•ng ngay l·∫≠p t·ª©c. B·∫°n c√≥ th·ªÉ xem tr∆∞·ªõc trong tab "Xem tr∆∞·ªõc website".
                        </div>
                        <button class="btn btn-custom" onclick="applyTheme()">
                            <i class="fas fa-paint-brush me-2"></i>√Åp d·ª•ng theme
                        </button>
                        <button class="btn btn-outline-secondary ms-2" onclick="resetTheme()">
                            <i class="fas fa-undo me-2"></i>Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh
                        </button>
                    </div>
                </div>
            </div>

            <!-- Layout Tab -->
            <div class="tab-pane fade" id="layout" role="tabpanel">
                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-th-large me-2"></i>B·ªë c·ª•c trang ch·ªß</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Ki·ªÉu header</label>
                                    <select class="form-control" id="headerStyle">
                                        <option value="hero">Hero Banner</option>
                                        <option value="minimal">Minimal</option>
                                        <option value="classic">Classic</option>
                                        <option value="modern">Modern</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Ki·ªÉu navigation</label>
                                    <select class="form-control" id="navStyle">
                                        <option value="top">Top Navigation</option>
                                        <option value="side">Side Navigation</option>
                                        <option value="floating">Floating</option>
                                        <option value="hidden">Hidden</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Ki·ªÉu footer</label>
                                    <select class="form-control" id="footerStyle">
                                        <option value="simple">Simple</option>
                                        <option value="detailed">Detailed</option>
                                        <option value="minimal">Minimal</option>
                                        <option value="none">None</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">B·ªë c·ª•c n·ªôi dung</label>
                                    <select class="form-control" id="contentLayout">
                                        <option value="single">Single Column</option>
                                        <option value="two-column">Two Column</option>
                                        <option value="grid">Grid</option>
                                        <option value="masonry">Masonry</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-cogs me-2"></i>T√πy ch·ªânh n√¢ng cao</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">Kho·∫£ng c√°ch gi·ªØa c√°c ph·∫ßn</label>
                                    <input type="range" class="form-range" id="sectionSpacing" min="0" max="100" value="50">
                                    <small class="form-text text-muted">50px</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ƒê·ªô bo g√≥c</label>
                                    <input type="range" class="form-range" id="borderRadius" min="0" max="20" value="8">
                                    <small class="form-text text-muted">8px</small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label">ƒê·ªô ƒë·ªï b√≥ng</label>
                                    <input type="range" class="form-range" id="boxShadow" min="0" max="20" value="5">
                                    <small class="form-text text-muted">5px</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Hi·ªáu ·ª©ng chuy·ªÉn ƒë·ªông</label>
                                    <select class="form-control" id="animationStyle">
                                        <option value="none">Kh√¥ng c√≥</option>
                                        <option value="fade">Fade</option>
                                        <option value="slide">Slide</option>
                                        <option value="zoom">Zoom</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-mobile-alt me-2"></i>T·ªëi ∆∞u mobile</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="mobileOptimized" checked>
                                    <label class="form-check-label" for="mobileOptimized">
                                        T·ªëi ∆∞u cho mobile
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="touchFriendly" checked>
                                    <label class="form-check-label" for="touchFriendly">
                                        Th√¢n thi·ªán v·ªõi c·∫£m ·ª©ng
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="fastLoading" checked>
                                    <label class="form-check-label" for="fastLoading">
                                        T·∫£i nhanh
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="seoOptimized" checked>
                                    <label class="form-check-label" for="seoOptimized">
                                        T·ªëi ∆∞u SEO
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-pane fade" id="settings" role="tabpanel">
                <div class="section-card">
                    <div class="section-header">
                        <h5><i class="fas fa-eye me-2"></i>Hi·ªÉn th·ªã c√°c ph·∫ßn</h5>
                    </div>
                    <div class="section-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="showGallery" checked>
                                    <label class="form-check-label" for="showGallery">
                                        Hi·ªÉn th·ªã th∆∞ vi·ªán ·∫£nh
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="showStory" checked>
                                    <label class="form-check-label" for="showStory">
                                        Hi·ªÉn th·ªã c√¢u chuy·ªán
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="showCouple" checked>
                                    <label class="form-check-label" for="showCouple">
                                        Hi·ªÉn th·ªã th√¥ng tin c·∫∑p ƒë√¥i
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="showRSVP" checked>
                                    <label class="form-check-label" for="showRSVP">
                                        Hi·ªÉn th·ªã ph·∫ßn x√°c nh·∫≠n tham d·ª±
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="showDonate" checked>
                                    <label class="form-check-label" for="showDonate">
                                        Hi·ªÉn th·ªã ph·∫ßn ch√∫c m·ª´ng
                                    </label>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="showAudio" checked>
                                    <label class="form-check-label" for="showAudio">
                                        Ph√°t nh·∫°c n·ªÅn
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div class="modal fade preview-modal" id="previewModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-eye me-2"></i>Xem tr∆∞·ªõc website
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0">
                    <iframe class="preview-frame" src="index.html" id="previewFrame"></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Actions -->
    <div class="floating-actions">
        <button class="floating-btn success" onclick="saveSiteData()" title="L∆∞u thay ƒë·ªïi">
            <i class="fas fa-save"></i>
        </button>
        <button class="floating-btn primary" onclick="previewWebsite()" title="Xem tr∆∞·ªõc">
            <i class="fas fa-eye"></i>
        </button>
        <button class="floating-btn info" onclick="loadDataFromIndex()" title="T·∫£i d·ªØ li·ªáu t·ª´ Index">
            <i class="fas fa-sync-alt"></i>
        </button>
        <button class="floating-btn secondary" onclick="scrollToTop()" title="Quay l·∫°i ƒë·∫ßu trang">
            <i class="fas fa-arrow-up"></i>
        </button>
    </div>

    <!-- Embedded site data for fallback -->
    <script>
    window.embeddedSiteData = {
        "meta": {
            "title": "Huy H√πng & Ng·ªçc Tr√¢m",
            "description": "Y√™u c√≤n h∆°n m√™. ƒê√≥ l√† nhu c·∫ßu ƒë∆∞·ª£c c·∫£m th·∫•y to√†n b·ªô, c·∫£m th·∫•y an to√†n, ƒë∆∞·ª£c ch·ªØa l√†nh, k·∫øt h·ª£p v·ªõi m·ªôt ai ƒë√≥, tr√°i tim v√† linh h·ªìn",
            "primaryColor": "#9f5958",
            "secondaryColor": "#ee8584",
            "accentColor": "#8E9D84"
        },
        "hero": {
            "groomName": "Huy H√πng",
            "brideName": "Ng·ªçc Tr√¢m",
            "weddingDate": "2025-05-03",
            "weddingTime": "11:00",
            "weddingLocation": "H√† N·ªôi, Vi·ªát Nam",
            "slides": [
                {
                    "id": "slide-1",
                    "src": "./public/images/banner/1736340563_gallery-04.webp",
                    "visible": true,
                    "title": "Slide 1",
                    "description": "·∫¢nh banner ch√≠nh"
                }
            ]
        },
        "couple": {
            "groomName": "Huy H√πng",
            "brideName": "Ng·ªçc Tr√¢m",
            "groomDescription": "L√† m·ªôt ng∆∞·ªùi hi·ªÅn l√†nh nh∆∞ng n√≥i nhi·ªÅu.",
            "brideDescription": "L√† m·ªôt ng∆∞·ªùi hay c∆∞·ªùi nh∆∞ng l·∫°i s·ªëng n·ªôi t√¢m.",
            "visible": true
        },
        "theme": {
            "primaryColor": "#9f5958",
            "secondaryColor": "#f8f9fa",
            "textColor": "#2c3e50",
            "backgroundColor": "#ffffff",
            "borderColor": "#dee2e6",
            "accentColor": "#e74c3c"
        }
    };
    </script>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- SQLite Admin Script -->
    <script>
        console.log('üöÄ SQLite Admin Script Started');
        
        let siteData = {};
        let isDataLoaded = false;
        
        // Load data from SQLite API
        async function loadSiteData() {
            console.log('üîÑ Loading data from SQLite...');
            
            try {
                const response = await fetch('http://localhost:5001/api/data');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                console.log('üì¶ SQLite API Result:', result);
                
                if (result.success && result.data) {
                    siteData = result.data;
                    isDataLoaded = true;
                    
                    console.log('‚úÖ Data loaded from SQLite:', siteData);
                    
                    // Update admin interface
                    updateAdminInterface();
                    
                    return;
                } else {
                    throw new Error('SQLite API returned unsuccessful response');
                }
            } catch (error) {
                console.error('‚ùå Error loading data from SQLite:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'L·ªói t·∫£i d·ªØ li·ªáu',
                    text: '‚ùå L·ªói khi t·∫£i d·ªØ li·ªáu: ' + error.message
                });
            }
        }
        
        // Update admin interface with loaded data
        function updateAdminInterface() {
            console.log('üîÑ Updating admin interface...');
            
            if (!isDataLoaded) {
                console.log('‚ùå Data not loaded, skipping interface update');
                return;
            }
            
            console.log('‚úÖ Updating admin interface with data:', siteData);
            
            // Update form fields
            updateFormFields();
        }
        
        // Update form fields with data
        function updateFormFields() {
            console.log('üîÑ Updating form fields...');
            
            // Hero section
            if (siteData.hero) {
                console.log('üë∞ Hero data:', siteData.hero);
                setFieldValue('groomName', siteData.hero.groomName);
                setFieldValue('brideName', siteData.hero.brideName);
                setFieldValue('weddingDate', siteData.hero.weddingDate);
                setFieldValue('weddingLocation', siteData.hero.weddingLocation);
            }
            
            // Meta information
            if (siteData.meta) {
                setFieldValue('mainTitle', siteData.meta.title);
                setFieldValue('description', siteData.meta.description);
            }
            
            // Couple information
            updateCoupleFormFields();
            
            // Payment information
            if (siteData.payment) {
                setFieldValue('bankName', siteData.payment.bankName);
                setFieldValue('accountNumber', siteData.payment.accountNumber);
                setFieldValue('accountHolder', siteData.payment.accountHolder);
                setFieldValue('paymentMessage', siteData.payment.message);
            }
            
            // Event information
            if (siteData.event) {
                setFieldValue('ceremonyDate', siteData.event.ceremonyDate);
                setFieldValue('ceremonyTime', siteData.event.ceremonyTime);
                setFieldValue('ceremonyVenue', siteData.event.ceremonyVenue);
                setFieldValue('ceremonyAddress', siteData.event.ceremonyAddress);
                setFieldValue('receptionDate', siteData.event.weddingDate);
                setFieldValue('receptionTime', siteData.event.receptionTime);
                setFieldValue('receptionVenue', siteData.event.receptionVenue);
                setFieldValue('receptionAddress', siteData.event.receptionAddress);
            }
            
            console.log('‚úÖ Form fields updated');
        }
        
        // Update couple form fields
        function updateCoupleFormFields() {
            console.log('üîÑ Updating couple form fields...');
            console.log('üìä siteData.couple:', siteData.couple);
            
            if (siteData.couple) {
                console.log('üë∞ Groom data:', siteData.couple.groom);
                console.log('üë∞ Bride data:', siteData.couple.bride);
                console.log('üë∞ Parents data:', siteData.couple.parents);
                
                // Update groom info - handle both old and new data structure
                const groomName = siteData.couple.groom?.name || siteData.couple.groomName || '';
                const groomDescription = siteData.couple.groom?.description || siteData.couple.groomDescription || '';
                const groomFather = siteData.couple.parents?.groom?.father || siteData.couple.groomFather || '';
                const groomMother = siteData.couple.parents?.groom?.mother || siteData.couple.groomMother || '';
                
                setFieldValue('groomNameDetail', groomName);
                setFieldValue('groomDescription', groomDescription);
                setFieldValue('groomFather', groomFather);
                setFieldValue('groomMother', groomMother);
                
                // Update bride info - handle both old and new data structure
                const brideName = siteData.couple.bride?.name || siteData.couple.brideName || '';
                const brideDescription = siteData.couple.bride?.description || siteData.couple.brideDescription || '';
                const brideFather = siteData.couple.parents?.bride?.father || siteData.couple.brideFather || '';
                const brideMother = siteData.couple.parents?.bride?.mother || siteData.couple.brideMother || '';
                
                setFieldValue('brideNameDetail', brideName);
                setFieldValue('brideDescription', brideDescription);
                setFieldValue('brideFather', brideFather);
                setFieldValue('brideMother', brideMother);
                
                // Update images
                updateCoupleImages();
                
                console.log('‚úÖ Couple form fields updated');
            } else {
                console.log('‚ùå No couple data found in siteData');
            }
        }
        
        // Update couple images
        function updateCoupleImages() {
            console.log('üîÑ Updating couple images...');
            console.log('üìä siteData.couple:', siteData.couple);
            
            if (siteData.couple) {
                // Update groom image
                if (siteData.couple.groomImage) {
                    console.log('üë∞ Updating groom image:', siteData.couple.groomImage);
                    const groomImg = document.getElementById('groom-image-preview');
                    if (groomImg) {
                        // Convert relative path to absolute URL with cache busting
                        const groomSrc = siteData.couple.groomImage.replace('./public/', 'http://localhost:5001/public/');
                        const timestamp = new Date().getTime();
                        const groomSrcWithCache = `${groomSrc}?t=${timestamp}`;
                        console.log('üë∞ Groom image src:', groomSrcWithCache);
                        groomImg.src = groomSrcWithCache;
                        groomImg.style.display = 'block';
                        // Hide placeholder
                        const groomPlaceholder = groomImg.parentElement.querySelector('.upload-placeholder');
                        if (groomPlaceholder) {
                            groomPlaceholder.style.display = 'none';
                        }
                        console.log('‚úÖ Groom image updated');
                    } else {
                        console.log('‚ùå Groom image element not found');
                    }
                } else {
                    console.log('‚ùå No groom image in siteData');
                }
                
                // Update bride image
                if (siteData.couple.brideImage) {
                    console.log('üë∞ Updating bride image:', siteData.couple.brideImage);
                    const brideImg = document.getElementById('bride-image-preview');
                    if (brideImg) {
                        // Convert relative path to absolute URL with cache busting
                        const brideSrc = siteData.couple.brideImage.replace('./public/', 'http://localhost:5001/public/');
                        const timestamp = new Date().getTime();
                        const brideSrcWithCache = `${brideSrc}?t=${timestamp}`;
                        console.log('üë∞ Bride image src:', brideSrcWithCache);
                        brideImg.src = brideSrcWithCache;
                        brideImg.style.display = 'block';
                        // Hide placeholder
                        const bridePlaceholder = brideImg.parentElement.querySelector('.upload-placeholder');
                        if (bridePlaceholder) {
                            bridePlaceholder.style.display = 'none';
                        }
                        console.log('‚úÖ Bride image updated');
                    } else {
                        console.log('‚ùå Bride image element not found');
                    }
                } else {
                    console.log('‚ùå No bride image in siteData');
                }
            } else {
                console.log('‚ùå No couple data in siteData');
            }
        }
        
        // Set field value helper
        function setFieldValue(fieldId, value) {
            const field = document.getElementById(fieldId);
            console.log(`üîß setFieldValue: ${fieldId} = ${value}, field found: ${!!field}`);
            
            if (field && value !== undefined) {
                if (field.type === 'checkbox') {
                    field.checked = !!value;
                    console.log(`‚úÖ Checkbox ${fieldId} set to: ${field.checked}`);
                } else {
                    field.value = value;
                    console.log(`‚úÖ Field ${fieldId} set to: ${field.value}`);
                }
            } else {
                if (!field) {
                    console.log(`‚ùå Field ${fieldId} not found in DOM`);
                }
                if (value === undefined) {
                    console.log(`‚ùå Value for ${fieldId} is undefined`);
                }
            }
        }
        
        // Save data to SQLite
        async function saveSiteData() {
            console.log('üíæ Saving data to SQLite...');
            
            try {
                // Collect all form data
                const formData = {
                    hero: {
                        groomName: document.getElementById('groomName')?.value || '',
                        brideName: document.getElementById('brideName')?.value || '',
                        weddingDate: document.getElementById('weddingDate')?.value || '',
                        weddingLocation: document.getElementById('weddingLocation')?.value || ''
                    },
                    meta: {
                        title: document.getElementById('mainTitle')?.value || '',
                        description: document.getElementById('description')?.value || ''
                    },
                    payment: {
                        bankName: document.getElementById('bankName')?.value || '',
                        accountNumber: document.getElementById('accountNumber')?.value || '',
                        accountHolder: document.getElementById('accountHolder')?.value || '',
                        message: document.getElementById('paymentMessage')?.value || ''
                    },
                    couple: {
                        groom: {
                            name: document.getElementById('groomNameDetail')?.value || '',
                            description: document.getElementById('groomDescription')?.value || ''
                        },
                        bride: {
                            name: document.getElementById('brideNameDetail')?.value || '',
                            description: document.getElementById('brideDescription')?.value || ''
                        },
                        parents: {
                            groom: {
                                father: document.getElementById('groomFather')?.value || '',
                                mother: document.getElementById('groomMother')?.value || ''
                            },
                            bride: {
                                father: document.getElementById('brideFather')?.value || '',
                                mother: document.getElementById('brideMother')?.value || ''
                            }
                        },
                        groomImage: (siteData.couple && siteData.couple.groomImage) || '',
                        brideImage: (siteData.couple && siteData.couple.brideImage) || '',
                        visible: true
                    },
                    event: {
                        ceremonyDate: document.getElementById('ceremonyDate')?.value || '',
                        ceremonyTime: document.getElementById('ceremonyTime')?.value || '',
                        ceremonyVenue: document.getElementById('ceremonyVenue')?.value || '',
                        ceremonyAddress: document.getElementById('ceremonyAddress')?.value || '',
                        weddingDate: document.getElementById('receptionDate')?.value || '',
                        receptionTime: document.getElementById('receptionTime')?.value || '',
                        receptionVenue: document.getElementById('receptionVenue')?.value || '',
                        receptionAddress: document.getElementById('receptionAddress')?.value || ''
                    }
                };
                
                console.log('üì¶ Form data collected:', formData);
                console.log('üì¶ Couple data specifically:', formData.couple);
                
                // Send to SQLite API
                const response = await fetch('http://localhost:5001/api/data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                console.log('‚úÖ Save result:', result);
                
                if (result.success) {
                    console.log('‚úÖ Data saved successfully to SQLite');
                    Swal.fire({
                        icon: 'success',
                        title: 'L∆∞u th√†nh c√¥ng!',
                        text: '‚úÖ D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng v√†o SQLite!'
                    }).then(() => {
                        // Reload data after saving
                        loadSiteData();
                    });
                } else {
                    console.error('‚ùå Save failed:', result.message);
                    Swal.fire({
                        icon: 'error',
                        title: 'L·ªói l∆∞u d·ªØ li·ªáu',
                        text: '‚ùå L·ªói khi l∆∞u d·ªØ li·ªáu: ' + result.message
                    });
                }
                
            } catch (error) {
                console.error('‚ùå Error saving data:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'L·ªói l∆∞u d·ªØ li·ªáu',
                    text: '‚ùå L·ªói khi l∆∞u d·ªØ li·ªáu: ' + error.message
                });
            }
        }
        
        // Select couple image function
        function selectCoupleImage(type) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = false;
            input.onchange = async function(e) {
                const file = e.target.files[0];
                if (file) {
                    await uploadCoupleImage(file, type);
                }
            };
            input.click();
        }
        
        // Upload couple image function
        async function uploadCoupleImage(file, type) {
            console.log(`üì∏ Uploading ${type} image:`, file.name);
            
            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('type', type);
                
                const response = await fetch('http://localhost:5001/api/upload', {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.success) {
                    const filename = result.data ? result.data.filename : result.filename;
                    
                    // Update siteData with new image
                    if (!siteData.couple) {
                        siteData.couple = {};
                    }
                    
                    if (type === 'groom') {
                        siteData.couple.groomImage = `./public/images/couple/${filename}`;
                        // Show image immediately with cache busting
                        const groomImg = document.getElementById('groom-image-preview');
                        if (groomImg) {
                            // Add timestamp to prevent browser cache
                            const timestamp = new Date().getTime();
                            groomImg.src = `http://localhost:5001/public/images/couple/${filename}?t=${timestamp}`;
                            groomImg.style.display = 'block';
                            const groomPlaceholder = groomImg.parentElement.querySelector('.upload-placeholder');
                            if (groomPlaceholder) {
                                groomPlaceholder.style.display = 'none';
                            }
                            console.log('üñºÔ∏è Updated groom image src:', groomImg.src);
                        }
                    } else if (type === 'bride') {
                        siteData.couple.brideImage = `./public/images/couple/${filename}`;
                        // Show image immediately with cache busting
                        const brideImg = document.getElementById('bride-image-preview');
                        if (brideImg) {
                            // Add timestamp to prevent browser cache
                            const timestamp = new Date().getTime();
                            brideImg.src = `http://localhost:5001/public/images/couple/${filename}?t=${timestamp}`;
                            brideImg.style.display = 'block';
                            const bridePlaceholder = brideImg.parentElement.querySelector('.upload-placeholder');
                            if (bridePlaceholder) {
                                bridePlaceholder.style.display = 'none';
                            }
                            console.log('üñºÔ∏è Updated bride image src:', brideImg.src);
                        }
                    }
                    
                    // Save to database immediately after upload
                    await saveSiteData();
                    
                    // Force reload the image after a short delay to ensure it's updated
                    setTimeout(() => {
                        if (type === 'groom') {
                            const groomImg = document.getElementById('groom-image-preview');
                            if (groomImg) {
                                const timestamp = new Date().getTime();
                                groomImg.src = `http://localhost:5001/public/images/couple/${filename}?t=${timestamp}`;
                                console.log('üîÑ Force reloaded groom image:', groomImg.src);
                            }
                        } else if (type === 'bride') {
                            const brideImg = document.getElementById('bride-image-preview');
                            if (brideImg) {
                                const timestamp = new Date().getTime();
                                brideImg.src = `http://localhost:5001/public/images/couple/${filename}?t=${timestamp}`;
                                console.log('üîÑ Force reloaded bride image:', brideImg.src);
                            }
                        }
                    }, 500);
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'Upload th√†nh c√¥ng!',
                        text: `‚úÖ ·∫¢nh ${type === 'groom' ? 'ch√∫ r·ªÉ' : 'c√¥ d√¢u'} ƒë√£ ƒë∆∞·ª£c upload v√† l∆∞u th√†nh c√¥ng!`
                    });
                    
                    console.log(`‚úÖ ${type} image uploaded and saved:`, filename);
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: 'L·ªói upload ·∫£nh',
                        text: `‚ùå L·ªói khi upload ·∫£nh ${type}: ` + result.message
                    });
                }
            } catch (error) {
                console.error(`‚ùå Error uploading ${type} image:`, error);
                Swal.fire({
                    icon: 'error',
                    title: 'L·ªói upload ·∫£nh',
                    text: `‚ùå L·ªói khi upload ·∫£nh ${type}: ` + error.message
                });
            }
        }
        
        // Upload banner image function
        async function uploadBannerImage(file) {
            console.log('üì∏ Uploading banner image:', file.name);
            
            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('type', 'banner');
                
                const response = await fetch('http://localhost:5001/api/upload', {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                console.log('‚úÖ Banner upload result:', result);
                
                if (result.success) {
                    // Add banner to database
                    const filename = result.data ? result.data.filename : result.filename;
                    await addBannerToDatabase(filename);
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'Upload th√†nh c√¥ng!',
                        text: '‚úÖ ·∫¢nh banner ƒë√£ ƒë∆∞·ª£c upload v√† l∆∞u v√†o database!'
                    });
                    
                    // Reload banner data
                    loadBannerData();
                    return filename;
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: 'L·ªói upload ·∫£nh',
                        text: '‚ùå L·ªói khi upload ·∫£nh banner: ' + result.message
                    });
                    return null;
                }
                
            } catch (error) {
                console.error('‚ùå Error uploading banner image:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'L·ªói upload ·∫£nh',
                    text: '‚ùå L·ªói khi upload ·∫£nh banner: ' + error.message
                });
                return null;
            }
        }
        
        // Add banner to database
        async function addBannerToDatabase(filename) {
            try {
                const bannerData = {
                    id: `banner-${Date.now()}`,
                    src: `./public/images/banner/${filename}`,
                    visible: true,
                    title: `Banner ${Date.now()}`,
                    description: '·∫¢nh banner m·ªõi'
                };
                
                // Get current data
                const response = await fetch('http://localhost:5001/api/data');
                const result = await response.json();
                
                if (result.success && result.data) {
                    const currentData = result.data;
                    
                    // Add banner to hero slides
                    if (!currentData.hero) {
                        currentData.hero = {};
                    }
                    if (!currentData.hero.slides) {
                        currentData.hero.slides = [];
                    }
                    
                    currentData.hero.slides.push(bannerData);
                    
                    // Save updated data
                    const saveResponse = await fetch('http://localhost:5001/api/data', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(currentData)
                    });
                    
                    const saveResult = await saveResponse.json();
                    console.log('‚úÖ Banner added to database:', saveResult);
                }
            } catch (error) {
                console.error('‚ùå Error adding banner to database:', error);
            }
        }
        
        // Load banner data from database
        async function loadBannerData() {
            console.log('üîÑ Loading banner data from database...');
            
            try {
                const response = await fetch('http://localhost:5001/api/data');
                const result = await response.json();
                
                if (result.success && result.data && result.data.hero && result.data.hero.slides) {
                    const bannerSlides = result.data.hero.slides;
                    console.log('üì¶ Banner slides loaded:', bannerSlides);
                    
                    // Store slides globally for selectBanner function
                    window.currentBannerSlides = bannerSlides;
                    
                    // Display banner slides
                    displayBannerSlides(bannerSlides);
                    
                    // Update preview with current form data
                    updateBannerPreview(bannerSlides);
                } else {
                    console.log('‚ùå No banner data found');
                    document.getElementById('bannerSlidesList').innerHTML = '<p class="text-muted">Ch∆∞a c√≥ ·∫£nh banner n√†o</p>';
                }
            } catch (error) {
                console.error('‚ùå Error loading banner data:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'L·ªói t·∫£i d·ªØ li·ªáu',
                    text: '‚ùå L·ªói khi t·∫£i d·ªØ li·ªáu banner: ' + error.message
                });
            }
        }
        
        // Refresh preview with current form data
        function refreshPreview() {
            const slides = window.currentBannerSlides || [];
            if (slides.length > 0) {
                updateBannerPreview(slides);
                Swal.fire({
                    icon: 'success',
                    title: 'ƒê√£ l√†m m·ªõi preview',
                    text: 'Preview ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t v·ªõi th√¥ng tin m·ªõi nh·∫•t'
                });
            } else {
                Swal.fire({
                    icon: 'info',
                    title: 'Ch∆∞a c√≥ banner',
                    text: 'Vui l√≤ng th√™m banner tr∆∞·ªõc khi xem preview'
                });
            }
        }
        
        // Display banner slides
        function displayBannerSlides(slides) {
            const container = document.getElementById('bannerSlidesList');
            
            if (!slides || slides.length === 0) {
                container.innerHTML = '<p class="text-muted">Ch∆∞a c√≥ ·∫£nh banner n√†o</p>';
                return;
            }
            
            let html = '<div class="row">';
            slides.forEach((slide, index) => {
                html += `
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="position-relative">
                                <img src="${slide.src}" class="card-img-top" style="width: 100%; height: 200px; object-fit: contain; background-color: #f8f9fa;" alt="${slide.title}" onclick="changeBannerImage('${slide.id}')">
                                <div class="position-absolute top-0 end-0 m-2">
                                    <span class="badge bg-primary">${index + 1}</span>
                                </div>
                                <div class="position-absolute top-0 start-0 m-2">
                                    <button class="btn btn-sm btn-outline-light" onclick="changeBannerImage('${slide.id}')" title="Thay ƒë·ªïi ·∫£nh">
                                        <i class="fas fa-camera"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <h6 class="card-title">${slide.title}</h6>
                                <p class="card-text small">${slide.description}</p>
                                <div class="btn-group w-100">
                                    <button class="btn btn-outline-primary btn-sm" onclick="editBannerSlide('${slide.id}')">
                                        <i class="fas fa-edit me-1"></i>Ch·ªânh s·ª≠a
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="deleteBannerSlide('${slide.id}')">
                                        <i class="fas fa-trash me-1"></i>X√≥a
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            
            container.innerHTML = html;
        }
        
        // Professional banner preview with slideshow
        function updateBannerPreview(slides) {
            const preview = document.getElementById('bannerPreview');
            
            if (!slides || slides.length === 0) {
                preview.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-images"></i>
                        </div>
                        <h4>Ch∆∞a c√≥ banner n√†o</h4>
                        <p>Th√™m banner ƒë·∫ßu ti√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu t·∫°o slideshow</p>
                        <button class="btn btn-primary" onclick="addBannerSlide()">
                            <i class="fas fa-plus me-2"></i>Th√™m banner ƒë·∫ßu ti√™n
                        </button>
                    </div>
                `;
                return;
            }
            
            // Get wedding info from form or database
            const groomName = document.getElementById('groom-name')?.value || 'Huy H√πng';
            const brideName = document.getElementById('bride-name')?.value || 'Ng·ªçc Tr√¢m';
            const weddingDate = document.getElementById('invitation_date')?.value || '31 th√°ng 12 2025';
            
            let html = `
                <div class="preview-container">
                    <!-- Main Preview Area with Slideshow -->
                    <div class="preview-main">
                        <div class="preview-slideshow">
                            <div class="preview-slides">
                                ${slides.map((slide, index) => `
                                    <div class="preview-slide ${index === 0 ? 'active' : ''}" style="background-image: url('${slide.src}')">
                                        <div class="preview-overlay">
                                            <div class="preview-content">
                                                <h2 class="preview-title">Save the Date</h2>
                                                <h1 class="preview-names">${groomName} & ${brideName}</h1>
                                                <p class="preview-date">${weddingDate}</p>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="preview-badge">
                                <span class="badge">Preview</span>
                            </div>
                            <div class="preview-controls">
                                <button class="preview-control-btn" onclick="pausePreviewSlideshow()">
                                    <i class="fas fa-pause"></i>
                                </button>
                                <button class="preview-control-btn" onclick="resumePreviewSlideshow()">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Banner Info -->
                    <div class="preview-info">
                        <div class="info-card">
                            <div class="info-header">
                                <h5><i class="fas fa-info-circle me-2"></i>Th√¥ng tin banner</h5>
                            </div>
                            <div class="info-content">
                                <div class="info-item">
                                    <label>T√™n ch√∫ r·ªÉ:</label>
                                    <span>${groomName}</span>
                                </div>
                                <div class="info-item">
                                    <label>T√™n c√¥ d√¢u:</label>
                                    <span>${brideName}</span>
                                </div>
                                <div class="info-item">
                                    <label>Ng√†y c∆∞·ªõi:</label>
                                    <span>${weddingDate}</span>
                                </div>
                                <div class="info-item">
                                    <label>T·ªïng s·ªë:</label>
                                    <span class="badge bg-primary">${slides.length} banner</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Thumbnail Gallery -->
                    <div class="preview-gallery">
                        <div class="gallery-header">
                            <h5><i class="fas fa-th me-2"></i>Th∆∞ vi·ªán banner</h5>
                            <span class="gallery-count">${slides.length} ·∫£nh</span>
                        </div>
                        <div class="gallery-grid">
                            ${slides.map((slide, index) => `
                                <div class="gallery-item ${index === 0 ? 'active' : ''}" onclick="selectBanner(${index})">
                                    <div class="gallery-image">
                                        <img src="${slide.src}" alt="${slide.title}">
                                        <div class="gallery-overlay">
                                            <span class="gallery-number">${index + 1}</span>
                                        </div>
                                    </div>
                                    <div class="gallery-info">
                                        <span class="gallery-title">${slide.title}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            preview.innerHTML = html;
            
            // Initialize slideshow
            initializePreviewSlideshow(slides.length);
        }
        
        // Slideshow variables
        let previewSlideshowInterval = null;
        let previewCurrentSlide = 0;
        let previewTotalSlides = 0;
        let previewSlideshowPaused = false;
        
        // Initialize preview slideshow
        function initializePreviewSlideshow(slideCount) {
            previewTotalSlides = slideCount;
            previewCurrentSlide = 0;
            
            // Clear existing interval
            if (previewSlideshowInterval) {
                clearInterval(previewSlideshowInterval);
            }
            
            // Start slideshow
            if (slideCount > 1) {
                previewSlideshowInterval = setInterval(() => {
                    if (!previewSlideshowPaused) {
                        nextPreviewSlide();
                    }
                }, 5000); // Change slide every 5 seconds
            }
            
            console.log(`üé¨ Preview slideshow initialized with ${slideCount} slides`);
        }
        
        // Next preview slide
        function nextPreviewSlide() {
            if (previewTotalSlides <= 1) return;
            
            previewCurrentSlide = (previewCurrentSlide + 1) % previewTotalSlides;
            showPreviewSlide(previewCurrentSlide);
        }
        
        // Show specific preview slide
        function showPreviewSlide(index) {
            const slides = document.querySelectorAll('.preview-slide');
            const galleryItems = document.querySelectorAll('.gallery-item');
            
            slides.forEach((slide, i) => {
                if (i === index) {
                    slide.classList.add('active');
                } else {
                    slide.classList.remove('active');
                }
            });
            
            galleryItems.forEach((item, i) => {
                if (i === index) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            previewCurrentSlide = index;
        }
        
        // Pause preview slideshow
        function pausePreviewSlideshow() {
            previewSlideshowPaused = true;
            console.log('‚è∏Ô∏è Preview slideshow paused');
        }
        
        // Resume preview slideshow
        function resumePreviewSlideshow() {
            previewSlideshowPaused = false;
            console.log('‚ñ∂Ô∏è Preview slideshow resumed');
        }
        
        // Select banner function
        function selectBanner(index) {
            const slides = window.currentBannerSlides || [];
            if (slides[index]) {
                // Show specific slide
                showPreviewSlide(index);
                
                console.log(`Selected banner ${index + 1}: ${slides[index].title}`);
            }
        }
        
        
        // Banner management functions
        
        // Change banner image
        function changeBannerImage(slideId) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = false;
            input.onchange = async function(e) {
                const file = e.target.files[0];
                if (file) {
                    try {
                        // Upload new image
                        const formData = new FormData();
                        formData.append('file', file);
                        formData.append('type', 'banner');
                        
                        const response = await fetch('http://localhost:5001/api/upload', {
                            method: 'POST',
                            body: formData
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            // Update banner in database
                            const filename = result.data ? result.data.filename : result.filename;
                            await updateBannerImage(slideId, filename);
                            
                            Swal.fire({
                                icon: 'success',
                                title: 'Thay ƒë·ªïi th√†nh c√¥ng!',
                                text: '‚úÖ ·∫¢nh banner ƒë√£ ƒë∆∞·ª£c thay ƒë·ªïi th√†nh c√¥ng!'
                            });
                            
                            // Reload banner data
                            loadBannerData();
                        } else {
                            Swal.fire({
                                icon: 'error',
                                title: 'L·ªói upload ·∫£nh',
                                text: '‚ùå L·ªói khi upload ·∫£nh banner: ' + result.message
                            });
                        }
                    } catch (error) {
                        console.error('‚ùå Error changing banner image:', error);
                        Swal.fire({
                            icon: 'error',
                            title: 'L·ªói thay ƒë·ªïi ·∫£nh',
                            text: '‚ùå L·ªói khi thay ƒë·ªïi ·∫£nh banner: ' + error.message
                        });
                    }
                }
            };
            input.click();
        }
        
        // Update banner image in database
        async function updateBannerImage(slideId, filename) {
            try {
                // Get current data
                const response = await fetch('http://localhost:5001/api/data');
                const result = await response.json();
                
                if (result.success && result.data) {
                    const currentData = result.data;
                    
                    // Update banner image
                    if (currentData.hero && currentData.hero.slides) {
                        const slideIndex = currentData.hero.slides.findIndex(slide => slide.id === slideId);
                        if (slideIndex !== -1) {
                            const oldSlide = currentData.hero.slides[slideIndex];
                            const oldFilePath = oldSlide.src;
                            
                            // Update with new image
                            currentData.hero.slides[slideIndex].src = `./public/images/banner/${filename}`;
                            
                            // Delete old file if it exists and is not the same as new file
                            if (oldFilePath && oldFilePath !== `./public/images/banner/${filename}`) {
                                try {
                                    await fetch('http://localhost:5001/api/delete-file', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify({
                                            file_path: oldFilePath
                                        })
                                    });
                                    console.log('üóëÔ∏è Old file deleted:', oldFilePath);
                                } catch (deleteError) {
                                    console.warn('‚ö†Ô∏è Could not delete old file:', deleteError);
                                }
                            }
                        }
                    }
                    
                    // Save updated data
                    const saveResponse = await fetch('http://localhost:5001/api/data', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(currentData)
                    });
                    
                    const saveResult = await saveResponse.json();
                    console.log('‚úÖ Banner image updated:', saveResult);
                }
            } catch (error) {
                console.error('‚ùå Error updating banner image:', error);
            }
        }
        
        function editBannerSlide(slideId) {
            Swal.fire({
                icon: 'info',
                title: 'Ch·ªânh s·ª≠a banner',
                text: 'Ch·ª©c nƒÉng ch·ªânh s·ª≠a banner s·∫Ω ƒë∆∞·ª£c ph√°t tri·ªÉn trong phi√™n b·∫£n ti·∫øp theo.'
            });
        }
        
        async function deleteBannerSlide(slideId) {
            const result = await Swal.fire({
                title: 'X√°c nh·∫≠n x√≥a',
                text: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ·∫£nh banner n√†y?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'X√≥a',
                cancelButtonText: 'H·ªßy'
            });
            
            if (result.isConfirmed) {
                try {
                    // Get current data
                    const response = await fetch('http://localhost:5001/api/data');
                    const result = await response.json();
                    
                    if (result.success && result.data) {
                        const currentData = result.data;
                        
                        // Remove banner from slides and delete file
                        if (currentData.hero && currentData.hero.slides) {
                            const slideToDelete = currentData.hero.slides.find(slide => slide.id === slideId);
                            if (slideToDelete && slideToDelete.src) {
                                // Delete file from server
                                try {
                                    await fetch('http://localhost:5001/api/delete-file', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify({
                                            file_path: slideToDelete.src
                                        })
                                    });
                                    console.log('üóëÔ∏è Banner file deleted:', slideToDelete.src);
                                } catch (deleteError) {
                                    console.warn('‚ö†Ô∏è Could not delete banner file:', deleteError);
                                }
                            }
                            
                            // Remove from slides array
                            currentData.hero.slides = currentData.hero.slides.filter(slide => slide.id !== slideId);
                        }
                        
                        // Save updated data
                        const saveResponse = await fetch('http://localhost:5001/api/data', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(currentData)
                        });
                        
                        const saveResult = await saveResponse.json();
                        
                        if (saveResult.success) {
                            Swal.fire({
                                icon: 'success',
                                title: 'X√≥a th√†nh c√¥ng!',
                                text: '‚úÖ ·∫¢nh banner ƒë√£ ƒë∆∞·ª£c x√≥a kh·ªèi database!'
                            });
                            
                            // Reload banner data
                            loadBannerData();
                        }
                    }
                } catch (error) {
                    console.error('‚ùå Error deleting banner:', error);
                    Swal.fire({
                        icon: 'error',
                        title: 'L·ªói x√≥a banner',
                        text: '‚ùå L·ªói khi x√≥a ·∫£nh banner: ' + error.message
                    });
                }
            }
        }
        
        function reloadBannerData() {
            loadBannerData();
        }
        
        function clearBannerSlides() {
            Swal.fire({
                icon: 'warning',
                title: 'X√°c nh·∫≠n x√≥a t·∫•t c·∫£',
                text: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t·∫•t c·∫£ ·∫£nh banner?',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'X√≥a t·∫•t c·∫£',
                cancelButtonText: 'H·ªßy'
            }).then(async (result) => {
                if (result.isConfirmed) {
                    try {
                        // Get current data
                        const response = await fetch('http://localhost:5001/api/data');
                        const result = await response.json();
                        
                        if (result.success && result.data) {
                            const currentData = result.data;
                            
                            // Clear banner slides
                            if (currentData.hero) {
                                currentData.hero.slides = [];
                            }
                            
                            // Save updated data
                            const saveResponse = await fetch('http://localhost:5001/api/data', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify(currentData)
                            });
                            
                            const saveResult = await saveResponse.json();
                            
                            if (saveResult.success) {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'X√≥a th√†nh c√¥ng!',
                                    text: '‚úÖ T·∫•t c·∫£ ·∫£nh banner ƒë√£ ƒë∆∞·ª£c x√≥a!'
                                });
                                
                                // Reload banner data
                                loadBannerData();
                            }
                        }
                    } catch (error) {
                        console.error('‚ùå Error clearing banners:', error);
                        Swal.fire({
                            icon: 'error',
                            title: 'L·ªói x√≥a banner',
                            text: '‚ùå L·ªói khi x√≥a t·∫•t c·∫£ ·∫£nh banner: ' + error.message
                        });
                    }
                }
            });
        }
        
        function addBannerSlide() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = false;
            input.onchange = async function(e) {
                const file = e.target.files[0];
                if (file) {
                    try {
                        // Upload new image
                        const formData = new FormData();
                        formData.append('file', file);
                        formData.append('type', 'banner');
                        
                        const response = await fetch('http://localhost:5001/api/upload', {
                            method: 'POST',
                            body: formData
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            // Add banner to database
                            const filename = result.data ? result.data.filename : result.filename;
                            await addBannerToDatabase(filename);
                            
                            Swal.fire({
                                icon: 'success',
                                title: 'Th√™m banner th√†nh c√¥ng!',
                                text: '‚úÖ ·∫¢nh banner ƒë√£ ƒë∆∞·ª£c th√™m th√†nh c√¥ng!'
                            });
                            
                            // Reload banner data
                            loadBannerData();
                        } else {
                            Swal.fire({
                                icon: 'error',
                                title: 'L·ªói upload ·∫£nh',
                                text: '‚ùå L·ªói khi upload ·∫£nh banner: ' + result.message
                            });
                        }
                    } catch (error) {
                        console.error('‚ùå Error uploading banner image:', error);
                        Swal.fire({
                            icon: 'error',
                            title: 'L·ªói upload ·∫£nh',
                            text: '‚ùå L·ªói khi upload ·∫£nh banner: ' + error.message
                        });
                    }
                }
            };
            input.click();
        }
        
        function refreshBannerPreview() {
            loadBannerData();
        }
        
        // Additional functions for compatibility
        function downloadData() {
            console.log('üì• Download data function called');
            Swal.fire({
                icon: 'info',
                title: 'Th√¥ng b√°o',
                text: 'Ch·ª©c nƒÉng t·∫£i file JSON ƒë√£ ƒë∆∞·ª£c thay th·∫ø b·∫±ng SQLite. D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l∆∞u trong database.'
            });
        }
        
        function loadData() {
            console.log('üì§ Load data function called');
            Swal.fire({
                icon: 'info',
                title: 'Th√¥ng b√°o',
                text: 'Ch·ª©c nƒÉng nh·∫≠p file JSON ƒë√£ ƒë∆∞·ª£c thay th·∫ø b·∫±ng SQLite. D·ªØ li·ªáu ƒë∆∞·ª£c load t·ª´ database.'
            }).then(() => {
                loadSiteData();
            });
        }
        
        function previewWebsite() {
            console.log('üëÅÔ∏è Preview website function called');
            window.open('http://localhost:5001/', '_blank');
        }
        
        function loadDataFromIndex() {
            console.log('üîÑ Load data from index function called');
            loadSiteData();
        }
        
        // Initialize admin when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ DOM Content Loaded, initializing admin...');
            
            // Load data from SQLite
            loadSiteData();
            
            // Load banner data
            loadBannerData();
            
            // Add save button event listeners
            const saveButtons = document.querySelectorAll('button[type="submit"], .btn-save, .btn-primary');
            saveButtons.forEach(button => {
                if (button.textContent.includes('L∆∞u') || button.textContent.includes('Save')) {
                    button.addEventListener('click', function(e) {
                        e.preventDefault();
                        console.log('üíæ Save button clicked:', button.textContent);
                        saveSiteData();
                    });
                }
            });
            
            // Add image upload event listeners
            const imageInputs = document.querySelectorAll('input[type="file"]');
            imageInputs.forEach(input => {
                input.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const type = input.getAttribute('data-type') || 'general';
                        uploadImage(file, type);
                    }
                });
            });
        });
    </script>
    
    <!-- Story Management Script -->
    <script src="admin/js/story-management.js?v=1759556253"></script>
</body>
</html>
