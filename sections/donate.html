<style>
    .neela-style {
    text-align: center;
    }
    #donate .image-wrapper {
    height: 150px;
    width: 150px;
    margin: 0 auto;
    display: block;
    border-radius: unset;
    }
    #donate .image-editor {
    overflow: hidden;
    height: 150px;
    width: 150px;
    margin: 0 auto;
    display: block;
    }
    #donate .movableImage {
    position: absolute;
    }
 </style>
 <style>
    #crop-area {
    margin: 20px auto;
    width: 350px;
    /* K√≠ch th∆∞·ªõc bi√™n gi·ªõi */
    height: 350px;
    }
    /* Styles for the modal */
    .modal {
    display: none;
    position: fixed;
    z-index: 100;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.5);
    }
    .modal-content {
    background-color: #fefefe;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    /* margin: 15% auto; */
    /* padding: 10px; */
    border: 1px solid #888;
    width: 350px;
    /* Width of the modal */
    position: relative;
    /* Th√™m thu·ªôc t√≠nh v·ªã tr√≠ */
    border-radius: 4px;
    }
    .modal-content h2 {
    text-align: center;
    font-size: 15px;
    text-transform: capitalize;
    padding: 30px 10px 10px;
    color: rgb(22, 28, 45);
    }
    .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    position: absolute;
    top: 7px;
    right: 7px;
    cursor: pointer;
    border-radius: 50% !important;
    padding: .45em !important;
    background: #c8cbd0 url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23464c53'%3E%3Cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3E%3C/svg%3E") 50%/.5em auto no-repeat !important;
    }
    .close:hover,
    .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
    }
    /* Styles cho kh·ªëi n√∫t */
    .button-group {
    display: flex;
    justify-content: space-between;
    /* CƒÉn gi·ªØa c√°c n√∫t */
    margin-top: 20px;
    /* Kho·∫£ng c√°ch ph√≠a tr√™n */
    align-items: center;
    border-bottom-left-radius: calc(.5rem - 1px);
    border-bottom-right-radius: calc(.5rem - 1px);
    border-top: 1px solid #f1f4f8;
    display: flex;
    flex-shrink: 0;
    flex-wrap: wrap;
    justify-content: flex-end;
    padding: 1.75rem;
    padding-bottom: 1rem !important;
    padding-top: 1rem !important;
    }
    /* Styles cho c√°c n√∫t */
    .button-group button {
    padding: 10px 20px;
    /* Kho·∫£ng c√°ch trong n√∫t */
    border: none;
    border-radius: 5px;
    /* Bo g√≥c */
    cursor: pointer;
    transition: background-color 0.3s;
    /* Hi·ªáu ·ª©ng chuy·ªÉn ti·∫øp */
    }
    /* Styles cho n√∫t c·∫Øt ·∫£nh */
    #crop-button {
    font-size: .9375rem;
    padding: .25rem .625rem;
    background-color: #2b50c7;
    color: white;
    }
    #crop-button:hover {
    background-color: #1336a8;
    /* M√†u n·ªÅn khi hover */
    }
    /* Styles cho n√∫t h·ªßy */
    #cancel-button {
    font-size: .9375rem;
    padding: .25rem .625rem;
    background-color: #506690;
    color: white;
    margin-right: 14px;
    }
    #cancel-button:hover {
    background-color: #1b3666;
    /* M√†u n·ªÅn khi hover */
    }
    #donate .font-style-h4 {
    font-family: "Open Sans", sans-serif;
    font-size: 16px;
    }
 </style>
<!-- Donate Section -->
<section id="donate" class="editable-parent scroll-to  ">
         <div class="children" style="display: block">
            <div class="container">
               <div class="row">
                  <div class="col-sm-12">
                     <h2 class="section-title">H·ªôp m·ª´ng c∆∞·ªõi</h2>
                     <!-- Global Message from API -->
                     <div id="payment-global-message" class="mb-4 px-6 text-center font-style-h4" style="display: none;">
                        <!-- Global message will be loaded here -->
                     </div>
                  </div>
               </div>
            </div>
            <div class="container donate-box">
               <div class="row justify-content-center" id="payment-cards-container">
                  <!-- Payment cards will be loaded dynamically here -->
               </div>
            </div>
         </div>
      </section>

<script>
// Load payment data from API
async function loadPaymentData() {
    try {
        console.log('üîÑ Loading payment data from API...');
        const response = await fetch('http://localhost:5001/api/payment/frontend');
        const data = await response.json();
        
        if (data.success) {
            console.log('‚úÖ Payment data loaded successfully:', data.data);
            renderPaymentData(data.data);
        } else {
            console.error('‚ùå Failed to load payment data:', data.message);
            renderDefaultPaymentData();
        }
    } catch (error) {
        console.error('‚ùå Error loading payment data:', error);
        renderDefaultPaymentData();
    }
}

// Render payment data from API
function renderPaymentData(paymentData) {
    const globalMessageEl = document.getElementById('payment-global-message');
    const cardsContainer = document.getElementById('payment-cards-container');
    
    // Show global message if exists
    if (paymentData.global_message && paymentData.global_message.trim()) {
        globalMessageEl.innerHTML = paymentData.global_message;
        globalMessageEl.style.display = 'block';
    } else {
        globalMessageEl.style.display = 'none';
    }
    
    // Clear existing cards
    cardsContainer.innerHTML = '';
    
    // Render payment cards
    if (paymentData.payments && paymentData.payments.length > 0) {
        paymentData.payments.forEach((payment, index) => {
            const cardHtml = createPaymentCard(payment, index);
            cardsContainer.innerHTML += cardHtml;
        });
    } else {
        // No payment data, show default
        renderDefaultPaymentData();
    }
}

// Create payment card HTML
function createPaymentCard(payment, index) {
    const qrCodeUrl = payment.qr_code_url || getDefaultQRCode(index);
    
    return `
                  <div class="col-sm-6 col-lg-4 donate-card">
                     <div class="map-info-container">
                <div class="info-wrapper animate-from-bottom animation-from-bottom mt-0" data-animation-direction="from-bottom" data-animation-delay="${(index + 1) * 100}">
                           <div class="location-info">
                              <div class="neela-style">
                                 <span class="h-lines"></span><span class="v-lines"></span>
                                 <span class="h-lines"></span>
                                 <span class="v-lines"></span><span class="h-lines">
                                 </span><span class="v-lines"></span>
                            <h4 class="fs-5">${payment.title || 'M·ª´ng c∆∞·ªõi'}</h4>
                                 <div class="editable image-editor">
                                    <div class="image-action">
                                       <svg class="unchange" width="170" height="24" viewBox="0 0 170 24" fill="white" xmlns="http://www.w3.org/2000/svg">
                                          <path d="M30.1477 17V5.36364H34.6023C35.4432 5.36364 36.142 5.49621 36.6989 5.76136C37.2595 6.02273 37.678 6.38068 37.9545 6.83523C38.2348 7.28977 38.375 7.80492 38.375 8.38068C38.375 8.85417 38.2841 9.25947 38.1023 9.59659C37.9205 9.92992 37.6761 10.2008 37.3693 10.4091C37.0625 10.6174 36.7197 10.767 36.3409 10.858V10.9716C36.7538 10.9943 37.1496 11.1212 37.5284 11.3523C37.911 11.5795 38.2235 11.9015 38.4659 12.3182C38.7083 12.7348 38.8295 13.2386 38.8295 13.8295C38.8295 14.4318 38.6837 14.9735 38.392 15.4545C38.1004 15.9318 37.661 16.3087 37.0739 16.5852C36.4867 16.8617 35.7481 17 34.858 17H30.1477ZM32.2557 15.2386H34.5227C35.2879 15.2386 35.839 15.0928 36.1761 14.8011C36.517 14.5057 36.6875 14.1269 36.6875 13.6648C36.6875 13.3201 36.6023 13.0095 36.4318 12.733C36.2614 12.4527 36.0189 12.233 35.7045 12.0739C35.3902 11.911 35.0152 11.8295 34.5795 11.8295H32.2557V15.2386ZM32.2557 10.3125H34.3409C34.7045 10.3125 35.0322 10.2462 35.3239 10.1136C35.6155 9.97727 35.8447 9.78598 36.0114 9.53977C36.1818 9.28977 36.267 8.99432 36.267 8.65341C36.267 8.20265 36.108 7.83144 35.7898 7.53977C35.4754 7.24811 35.0076 7.10227 34.3864 7.10227H32.2557V10.3125ZM42.9038 17.1761C42.3508 17.1761 41.8527 17.0777 41.4095 16.8807C40.9701 16.6799 40.6216 16.3845 40.364 15.9943C40.1102 15.6042 39.9834 15.1231 39.9834 14.5511C39.9834 14.0587 40.0743 13.6515 40.2561 13.3295C40.4379 13.0076 40.686 12.75 41.0004 12.5568C41.3148 12.3636 41.669 12.2178 42.0629 12.1193C42.4606 12.017 42.8716 11.9432 43.2959 11.8977C43.8072 11.8447 44.222 11.7973 44.5402 11.7557C44.8584 11.7102 45.0894 11.642 45.2334 11.5511C45.3811 11.4564 45.4549 11.3106 45.4549 11.1136V11.0795C45.4549 10.6515 45.328 10.3201 45.0743 10.0852C44.8205 9.85038 44.4549 9.73295 43.9777 9.73295C43.4739 9.73295 43.0743 9.8428 42.7788 10.0625C42.4871 10.2822 42.2902 10.5417 42.1879 10.8409L40.2674 10.5682C40.419 10.0379 40.669 9.5947 41.0174 9.23864C41.3659 8.87879 41.7921 8.60985 42.2959 8.43182C42.7996 8.25 43.3565 8.15909 43.9663 8.15909C44.3868 8.15909 44.8053 8.20833 45.222 8.30682C45.6387 8.4053 46.0193 8.56818 46.364 8.79545C46.7087 9.01894 46.9852 9.32386 47.1936 9.71023C47.4057 10.0966 47.5118 10.5795 47.5118 11.1591V17H45.5345V15.8011H45.4663C45.3413 16.0436 45.1652 16.2708 44.9379 16.483C44.7144 16.6913 44.4322 16.8598 44.0913 16.9886C43.7542 17.1136 43.3584 17.1761 42.9038 17.1761ZM43.4379 15.6648C43.8508 15.6648 44.2087 15.5833 44.5118 15.4205C44.8148 15.2538 45.0477 15.0341 45.2106 14.7614C45.3773 14.4886 45.4606 14.1913 45.4606 13.8693V12.8409C45.3962 12.8939 45.2864 12.9432 45.1311 12.9886C44.9796 13.0341 44.8091 13.0739 44.6197 13.108C44.4303 13.142 44.2428 13.1723 44.0572 13.1989C43.8716 13.2254 43.7106 13.2481 43.5743 13.267C43.2674 13.3087 42.9928 13.3769 42.7504 13.4716C42.508 13.5663 42.3167 13.6989 42.1765 13.8693C42.0364 14.036 41.9663 14.2519 41.9663 14.517C41.9663 14.8958 42.1046 15.1818 42.3811 15.375C42.6576 15.5682 43.0099 15.6648 43.4379 15.6648ZM41.1084 7.27273L43.4095 5.40341H44.6936L47.0061 7.27273H45.2959L44.0629 6.22727L42.8243 7.27273H41.1084ZM46.3981 6.13636L47.6595 4.03977H49.4663L47.7106 6.13636H46.3981ZM49.3999 17V8.27273H51.3659V9.75568H51.4681C51.6499 9.25568 51.9511 8.86553 52.3715 8.58523C52.792 8.30114 53.2939 8.15909 53.8772 8.15909C54.4681 8.15909 54.9662 8.30303 55.3715 8.59091C55.7806 8.875 56.0685 9.26326 56.2352 9.75568H56.3261C56.5193 9.27083 56.845 8.88447 57.3034 8.59659C57.7655 8.30492 58.3128 8.15909 58.9454 8.15909C59.7484 8.15909 60.4037 8.41288 60.9113 8.92045C61.4189 9.42803 61.6727 10.1686 61.6727 11.142V17H59.6102V11.4602C59.6102 10.9186 59.4662 10.5227 59.1784 10.2727C58.8905 10.0189 58.5382 9.89205 58.1215 9.89205C57.6253 9.89205 57.2371 10.0473 56.9568 10.358C56.6802 10.6648 56.542 11.0644 56.542 11.5568V17H54.5249V11.375C54.5249 10.9242 54.3886 10.5644 54.1159 10.2955C53.8469 10.0265 53.4946 9.89205 53.059 9.89205C52.7636 9.89205 52.4946 9.9678 52.2522 10.1193C52.0098 10.267 51.8166 10.4773 51.6727 10.75C51.5287 11.0189 51.4568 11.3333 51.4568 11.6932V17H49.3999ZM70.6067 17.1534C69.9211 17.1534 69.3075 16.9773 68.7658 16.625C68.2241 16.2727 67.7961 15.7614 67.4817 15.0909C67.1673 14.4205 67.0101 13.6061 67.0101 12.6477C67.0101 11.678 67.1692 10.8598 67.4874 10.1932C67.8094 9.52273 68.2431 9.01705 68.7885 8.67614C69.334 8.33144 69.9419 8.15909 70.6124 8.15909C71.1237 8.15909 71.5442 8.24621 71.8737 8.42045C72.2033 8.59091 72.4647 8.79735 72.6578 9.03977C72.851 9.27841 73.0006 9.50379 73.1067 9.71591H73.1919V5.36364H75.2544V17H73.2317V15.625H73.1067C73.0006 15.8371 72.8472 16.0625 72.6465 16.3011C72.4457 16.536 72.1806 16.7367 71.851 16.9034C71.5215 17.0701 71.1067 17.1534 70.6067 17.1534ZM71.1806 15.4659C71.6162 15.4659 71.9874 15.3485 72.2942 15.1136C72.601 14.875 72.834 14.5436 72.9931 14.1193C73.1522 13.6951 73.2317 13.2008 73.2317 12.6364C73.2317 12.072 73.1522 11.5814 72.9931 11.1648C72.8378 10.7481 72.6067 10.4242 72.2999 10.1932C71.9969 9.96212 71.6237 9.84659 71.1806 9.84659C70.7222 9.84659 70.3397 9.96591 70.0328 10.2045C69.726 10.4432 69.495 10.7727 69.3397 11.1932C69.1844 11.6136 69.1067 12.0947 69.1067 12.6364C69.1067 13.1818 69.1844 13.6686 69.3397 14.0966C69.4987 14.5208 69.7317 14.8561 70.0385 15.1023C70.3491 15.3447 70.7298 15.4659 71.1806 15.4659ZM70.8851 7.61932V6.31818H76.3283V7.61932H70.8851ZM81.1298 17.1705C80.2548 17.1705 79.4991 16.9886 78.8628 16.625C78.2302 16.2576 77.7435 15.7386 77.4026 15.0682C77.0616 14.3939 76.8912 13.6004 76.8912 12.6875C76.8912 11.7898 77.0616 11.0019 77.4026 10.3239C77.7473 9.64205 78.2283 9.11174 78.8457 8.73295C79.4632 8.35038 80.1885 8.15909 81.0219 8.15909C81.5598 8.15909 82.0673 8.24621 82.5446 8.42045C83.0257 8.59091 83.4499 8.85606 83.8173 9.21591C84.1885 9.57576 84.4802 10.0341 84.6923 10.5909C84.9044 11.1439 85.0105 11.803 85.0105 12.5682V13.1989H77.8571V11.8125H83.0389C83.0351 11.4186 82.9499 11.0682 82.7832 10.7614C82.6166 10.4508 82.3836 10.2064 82.0844 10.0284C81.7889 9.85038 81.4442 9.76136 81.0503 9.76136C80.6298 9.76136 80.2605 9.86364 79.9423 10.0682C79.6241 10.2689 79.376 10.5341 79.198 10.8636C79.0238 11.1894 78.9348 11.5473 78.931 11.9375V13.1477C78.931 13.6553 79.0238 14.0909 79.2094 14.4545C79.395 14.8144 79.6544 15.0909 79.9878 15.2841C80.3211 15.4735 80.7113 15.5682 81.1582 15.5682C81.4575 15.5682 81.7283 15.5265 81.9707 15.4432C82.2132 15.3561 82.4234 15.2292 82.6014 15.0625C82.7794 14.8958 82.9139 14.6894 83.0048 14.4432L84.9253 14.6591C84.8041 15.1667 84.573 15.6098 84.2321 15.9886C83.895 16.3636 83.4632 16.6553 82.9366 16.8636C82.4101 17.0682 81.8079 17.1705 81.1298 17.1705ZM81.6753 5.5L83.8912 7.36932H82.306L80.9537 6.22727L79.5957 7.36932H78.0105L80.2264 5.5H81.6753ZM84.306 6.34091H83.1526L83.0787 5.42045C83.4007 5.40151 83.6355 5.35985 83.7832 5.29545C83.9348 5.22727 84.0105 5.12311 84.0105 4.98295C84.0105 4.80492 83.9158 4.68371 83.7264 4.61932C83.537 4.55114 83.2965 4.51705 83.0048 4.51705L83.0616 3.65909C83.8041 3.65909 84.3666 3.77273 84.7491 4C85.1355 4.22727 85.3287 4.53977 85.3287 4.9375C85.3287 5.24432 85.2226 5.47348 85.0105 5.625C84.7984 5.77651 84.5635 5.87121 84.306 5.90909V6.34091ZM94.7173 8.27273V9.86364H89.7002V8.27273H94.7173ZM90.9389 6.18182H92.9957V14.375C92.9957 14.6515 93.0374 14.8636 93.1207 15.0114C93.2078 15.1553 93.3214 15.2538 93.4616 15.3068C93.6017 15.3598 93.757 15.3864 93.9275 15.3864C94.0563 15.3864 94.1737 15.3769 94.2798 15.358C94.3896 15.339 94.473 15.322 94.5298 15.3068L94.8764 16.9148C94.7665 16.9527 94.6093 16.9943 94.4048 17.0398C94.204 17.0852 93.9578 17.1117 93.6661 17.1193C93.151 17.1345 92.687 17.0568 92.2741 16.8864C91.8612 16.7121 91.5336 16.4432 91.2911 16.0795C91.0525 15.7159 90.9351 15.2614 90.9389 14.7159V6.18182ZM98.7688 17.1761C98.2158 17.1761 97.7177 17.0777 97.2745 16.8807C96.8351 16.6799 96.4866 16.3845 96.229 15.9943C95.9752 15.6042 95.8483 15.1231 95.8483 14.5511C95.8483 14.0587 95.9393 13.6515 96.1211 13.3295C96.3029 13.0076 96.551 12.75 96.8654 12.5568C97.1798 12.3636 97.534 12.2178 97.9279 12.1193C98.3256 12.017 98.7366 11.9432 99.1609 11.8977C99.6722 11.8447 100.087 11.7973 100.405 11.7557C100.723 11.7102 100.954 11.642 101.098 11.5511C101.246 11.4564 101.32 11.3106 101.32 11.1136V11.0795C101.32 10.6515 101.193 10.3201 100.939 10.0852C100.685 9.85038 100.32 9.73295 99.8427 9.73295C99.3389 9.73295 98.9393 9.8428 98.6438 10.0625C98.3521 10.2822 98.1552 10.5417 98.0529 10.8409L96.1324 10.5682C96.284 10.0379 96.534 9.5947 96.8824 9.23864C97.2309 8.87879 97.6571 8.60985 98.1608 8.43182C98.6646 8.25 99.2215 8.15909 99.8313 8.15909C100.252 8.15909 100.67 8.20833 101.087 8.30682C101.504 8.4053 101.884 8.56818 102.229 8.79545C102.574 9.01894 102.85 9.32386 103.059 9.71023C103.271 10.0966 103.377 10.5795 103.377 11.1591V17H101.399V15.8011H101.331C101.206 16.0436 101.03 16.2708 100.803 16.483C100.579 16.6913 100.297 16.8598 99.9563 16.9886C99.6192 17.1136 99.2233 17.1761 98.7688 17.1761ZM99.3029 15.6648C99.7158 15.6648 100.074 15.5833 100.377 15.4205C100.68 15.2538 100.913 15.0341 101.076 14.7614C101.242 14.4886 101.326 14.1913 101.326 13.8693V12.8409C101.261 12.8939 101.151 12.9432 100.996 12.9886C100.845 13.0341 100.674 13.0739 100.485 13.108C100.295 13.142 100.108 13.1723 99.9222 13.1989C99.7366 13.2254 99.5756 13.2481 99.4393 13.267C99.1324 13.3087 98.8578 13.3769 98.6154 13.4716C98.373 13.5663 98.1817 13.6989 98.0415 13.8693C97.9014 14.036 97.8313 14.2519 97.8313 14.517C97.8313 14.8958 97.9696 15.1818 98.2461 15.375C98.5226 15.5682 98.8749 15.6648 99.3029 15.6648ZM100.712 7.04545H99.1438L99.0643 5.95455C99.4658 5.93939 99.7499 5.88826 99.9165 5.80114C100.083 5.71023 100.165 5.58523 100.161 5.42614C100.165 5.22159 100.055 5.07955 99.8313 5C99.6078 4.92045 99.3313 4.88068 99.0018 4.88068L99.0529 3.86364C99.9923 3.86364 100.704 4 101.189 4.27273C101.674 4.54545 101.915 4.91667 101.911 5.38636C101.915 5.74621 101.792 6.01515 101.542 6.19318C101.292 6.36742 101.015 6.47727 100.712 6.52273V7.04545ZM105.265 17V8.27273H107.322V17H105.265ZM106.299 7.03409C105.973 7.03409 105.693 6.92614 105.458 6.71023C105.223 6.49053 105.106 6.22727 105.106 5.92045C105.106 5.60985 105.223 5.34659 105.458 5.13068C105.693 4.91098 105.973 4.80114 106.299 4.80114C106.629 4.80114 106.909 4.91098 107.14 5.13068C107.375 5.34659 107.492 5.60985 107.492 5.92045C107.492 6.22727 107.375 6.49053 107.14 6.71023C106.909 6.92614 106.629 7.03409 106.299 7.03409ZM115.557 17.1761C115.004 17.1761 114.506 17.0777 114.063 16.8807C113.623 16.6799 113.275 16.3845 113.017 15.9943C112.763 15.6042 112.636 15.1231 112.636 14.5511C112.636 14.0587 112.727 13.6515 112.909 13.3295C113.091 13.0076 113.339 12.75 113.654 12.5568C113.968 12.3636 114.322 12.2178 114.716 12.1193C115.114 12.017 115.525 11.9432 115.949 11.8977C116.46 11.8447 116.875 11.7973 117.193 11.7557C117.511 11.7102 117.743 11.642 117.886 11.5511C118.034 11.4564 118.108 11.3106 118.108 11.1136V11.0795C118.108 10.6515 117.981 10.3201 117.727 10.0852C117.474 9.85038 117.108 9.73295 116.631 9.73295C116.127 9.73295 115.727 9.8428 115.432 10.0625C115.14 10.2822 114.943 10.5417 114.841 10.8409L112.921 10.5682C113.072 10.0379 113.322 9.5947 113.671 9.23864C114.019 8.87879 114.445 8.60985 114.949 8.43182C115.453 8.25 116.01 8.15909 116.619 8.15909C117.04 8.15909 117.458 8.20833 117.875 8.30682C118.292 8.4053 118.672 8.56818 119.017 8.79545C119.362 9.01894 119.638 9.32386 119.847 9.71023C120.059 10.0966 120.165 10.5795 120.165 11.1591V17H118.188V15.8011H118.119C117.994 16.0436 117.818 16.2708 117.591 16.483C117.368 16.6913 117.085 16.8598 116.744 16.9886C116.407 17.1136 116.011 17.1761 115.557 17.1761ZM116.091 15.6648C116.504 15.6648 116.862 15.5833 117.165 15.4205C117.468 15.2538 117.701 15.0341 117.864 14.7614C118.03 14.4886 118.114 14.1913 118.114 13.8693V12.8409C118.049 12.8939 117.94 12.9432 117.784 12.9886C117.633 13.0341 117.462 13.0739 117.273 13.108C117.083 13.142 116.896 13.1723 116.71 13.1989C116.525 13.2254 116.364 13.2481 116.227 13.267C115.921 13.3087 115.646 13.3769 115.404 13.4716C115.161 13.5663 114.97 13.6989 114.83 13.8693C114.69 14.036 114.619 14.2519 114.619 14.517C114.619 14.8958 114.758 15.1818 115.034 15.375C115.311 15.5682 115.663 15.6648 116.091 15.6648ZM117.5 7.04545H115.932L115.852 5.95455C116.254 5.93939 116.538 5.88826 116.705 5.80114C116.871 5.71023 116.953 5.58523 116.949 5.42614C116.953 5.22159 116.843 5.07955 116.619 5C116.396 4.92045 116.119 4.88068 115.79 4.88068L115.841 3.86364C116.78 3.86364 117.493 4 117.977 4.27273C118.462 4.54545 118.703 4.91667 118.699 5.38636C118.703 5.74621 118.58 6.01515 118.33 6.19318C118.08 6.36742 117.803 6.47727 117.5 6.52273V7.04545ZM124.11 11.8864V17H122.053V8.27273H124.019V9.75568H124.121C124.322 9.26705 124.642 8.87879 125.081 8.59091C125.525 8.30303 126.072 8.15909 126.724 8.15909C127.326 8.15909 127.85 8.28788 128.297 8.54545C128.748 8.80303 129.097 9.17614 129.343 9.66477C129.593 10.1534 129.716 10.7462 129.712 11.4432V17H127.655V11.7614C127.655 11.178 127.504 10.7216 127.201 10.392C126.902 10.0625 126.487 9.89773 125.956 9.89773C125.597 9.89773 125.277 9.97727 124.996 10.1364C124.72 10.2917 124.502 10.517 124.343 10.8125C124.188 11.108 124.11 11.4659 124.11 11.8864ZM133.68 11.8864V17H131.623V5.36364H133.634V9.75568H133.737C133.941 9.26326 134.258 8.875 134.686 8.59091C135.117 8.30303 135.667 8.15909 136.333 8.15909C136.939 8.15909 137.468 8.28598 137.919 8.53977C138.369 8.79356 138.718 9.16477 138.964 9.65341C139.214 10.142 139.339 10.7386 139.339 11.4432V17H137.282V11.7614C137.282 11.1742 137.131 10.7178 136.828 10.392C136.528 10.0625 136.108 9.89773 135.566 9.89773C135.203 9.89773 134.877 9.97727 134.589 10.1364C134.305 10.2917 134.081 10.517 133.919 10.8125C133.759 11.108 133.68 11.4659 133.68 11.8864ZM147.101 5.36364V17H145.044V5.36364H147.101ZM152.9 17.1705C152.025 17.1705 151.269 16.9886 150.633 16.625C150 16.2576 149.513 15.7386 149.173 15.0682C148.832 14.3939 148.661 13.6004 148.661 12.6875C148.661 11.7898 148.832 11.0019 149.173 10.3239C149.517 9.64205 149.998 9.11174 150.616 8.73295C151.233 8.35038 151.959 8.15909 152.792 8.15909C153.33 8.15909 153.837 8.24621 154.315 8.42045C154.796 8.59091 155.22 8.85606 155.587 9.21591C155.959 9.57576 156.25 10.0341 156.462 10.5909C156.674 11.1439 156.781 11.803 156.781 12.5682V13.1989H149.627V11.8125H154.809C154.805 11.4186 154.72 11.0682 154.553 10.7614C154.387 10.4508 154.154 10.2064 153.854 10.0284C153.559 9.85038 153.214 9.76136 152.82 9.76136C152.4 9.76136 152.031 9.86364 151.712 10.0682C151.394 10.2689 151.146 10.5341 150.968 10.8636C150.794 11.1894 150.705 11.5473 150.701 11.9375V13.1477C150.701 13.6553 150.794 14.0909 150.979 14.4545C151.165 14.8144 151.424 15.0909 151.758 15.2841C152.091 15.4735 152.481 15.5682 152.928 15.5682C153.227 15.5682 153.498 15.5265 153.741 15.4432C153.983 15.3561 154.193 15.2292 154.371 15.0625C154.549 14.8958 154.684 14.6894 154.775 14.4432L156.695 14.6591C156.574 15.1667 156.343 15.6098 156.002 15.9886C155.665 16.3636 155.233 16.6553 154.707 16.8636C154.18 17.0682 153.578 17.1705 152.9 17.1705ZM153.888 7.22727L152.735 5.77273L151.582 7.22727H149.781V7.14773L151.934 4.69318H153.542L155.69 7.14773V7.22727H153.888ZM160.397 11.8864V17H158.341V8.27273H160.306V9.75568H160.409C160.61 9.26705 160.93 8.87879 161.369 8.59091C161.812 8.30303 162.36 8.15909 163.011 8.15909C163.613 8.15909 164.138 8.28788 164.585 8.54545C165.036 8.80303 165.384 9.17614 165.63 9.66477C165.88 10.1534 166.003 10.7462 166 11.4432V17H163.943V11.7614C163.943 11.178 163.791 10.7216 163.488 10.392C163.189 10.0625 162.774 9.89773 162.244 9.89773C161.884 9.89773 161.564 9.97727 161.284 10.1364C161.007 10.2917 160.789 10.517 160.63 10.8125C160.475 11.108 160.397 11.4659 160.397 11.8864Z" fill="white"></path>
                                          <path d="M10.0011 14.1367L10.0011 1M10.0011 1L4.4519 6.0195M10.0011 1L15.5503 6.0195M1 18.563V20.121C1.4553 20.5558 2.07281 20.8 2.71669 20.8H17.2833C17.9272 20.8 18.5447 20.5558 19 20.121V18.563" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                       </svg>
                                    </div>
                                    <input type="file" class="img-up-load" accept="image/*" style="display: none">
                                    <div class="image-wrapper img-gif-box">
                                    <img class="fullwidthimg qr-code-image qr-code-image-zoom m-auto mb-2 edit-im output-image" 
                                         data-width="1200" data-height="1200" 
                                         src="${qrCodeUrl}" 
                                         alt="${payment.title || 'QR Code'}"
                                         onerror="this.src='${getDefaultQRCode(index)}'">
                                    </div>
                                 </div>
                            <p class="editable font-style-h4" style="padding-top: 15px;">
                                ${payment.description || ''}
                                ${payment.bank_name ? `<br>Ng√¢n h√†ng: ${payment.bank_name}` : ''}
                                ${payment.recipient_name ? `<br>T√™n: ${payment.recipient_name}` : ''}
                                ${payment.account_number ? `<br>STK: ${payment.account_number}` : ''}
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
    `;
}

// Get default QR code based on index
function getDefaultQRCode(index) {
    return index % 2 === 0 ? 
        '/public/images/default/qr/qr_man.webp' : 
        '/public/images/default/qr/qr_woman.webp';
}

// Render default payment data when API fails
function renderDefaultPaymentData() {
    console.log('üîÑ Rendering default payment data...');
    const cardsContainer = document.getElementById('payment-cards-container');
    
    const defaultPayments = [
        {
            title: 'M·ª´ng c∆∞·ªõi ƒë·∫øn ch√∫ r·ªÉ',
            bank_name: 'T√™n ng√¢n h√†ng',
            recipient_name: 'T√™n ch·ªß t√†i kho·∫£n',
            account_number: 'S·ªë t√†i kho·∫£n',
            qr_code_url: '/public/images/default/qr/qr_man.webp'
        }
    ];
    
    cardsContainer.innerHTML = '';
    defaultPayments.forEach((payment, index) => {
        const cardHtml = createPaymentCard(payment, index);
        cardsContainer.innerHTML += cardHtml;
    });
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    console.log('üîÑ DOM loaded, initializing payment data...');
    loadPaymentData();
});

// Also initialize when window loads (fallback)
window.addEventListener('load', function() {
    console.log('üîÑ Window loaded, checking payment data...');
    const cardsContainer = document.getElementById('payment-cards-container');
    if (cardsContainer && cardsContainer.children.length === 0) {
        console.log('üîÑ No payment cards found, loading data...');
        loadPaymentData();
    }
});
</script>
